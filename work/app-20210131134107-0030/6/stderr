Spark Executor Command: "/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/bin/java" "-cp" "/Users/kinsho/workspace/spark-3.0.1/conf/:/Users/kinsho/workspace/spark-3.0.1/assembly/target/scala-2.12/jars/*" "-Xmx1024M" "-Dspark.driver.port=51030" "org.apache.spark.executor.CoarseGrainedExecutorBackend" "--driver-url" "spark://CoarseGrainedScheduler@192.168.11.7:51030" "--executor-id" "6" "--hostname" "192.168.11.7" "--cores" "2" "--app-id" "app-20210131134107-0030" "--worker-url" "spark://Worker@192.168.11.7:63887"
========================================

Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
21/01/31 13:41:09 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 27468@ST000000035
21/01/31 13:41:09 INFO SignalUtils: Registered signal handler for TERM
21/01/31 13:41:09 INFO SignalUtils: Registered signal handler for HUP
21/01/31 13:41:09 INFO SignalUtils: Registered signal handler for INT
21/01/31 13:41:10 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
21/01/31 13:41:10 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 13:41:10 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 13:41:10 INFO SecurityManager: Changing view acls groups to: 
21/01/31 13:41:10 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 13:41:10 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 13:41:11 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:51030 after 129 ms (0 ms spent in bootstraps)
21/01/31 13:41:11 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 13:41:11 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 13:41:11 INFO SecurityManager: Changing view acls groups to: 
21/01/31 13:41:11 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 13:41:11 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 13:41:11 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:51030 after 3 ms (0 ms spent in bootstraps)
21/01/31 13:41:11 INFO DiskBlockManager: Created local directory at /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-56526756-d62c-425a-9228-330d931c7738/executor-9a792b04-3b1c-4c86-9b27-dcff78b59c58/blockmgr-bf8d07ea-0dba-4923-9931-07428b5bf4fe
21/01/31 13:41:11 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
21/01/31 13:41:11 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@192.168.11.7:51030
21/01/31 13:41:11 INFO WorkerWatcher: Connecting to worker spark://Worker@192.168.11.7:63887
21/01/31 13:41:11 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:63887 after 3 ms (0 ms spent in bootstraps)
21/01/31 13:41:11 INFO ResourceUtils: ==============================================================
21/01/31 13:41:11 INFO ResourceUtils: Resources for spark.executor:

21/01/31 13:41:11 INFO ResourceUtils: ==============================================================
21/01/31 13:41:11 INFO CoarseGrainedExecutorBackend: Successfully registered with driver
21/01/31 13:41:11 INFO Executor: Starting executor ID 6 on host 192.168.11.7
21/01/31 13:41:12 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 51086.
21/01/31 13:41:12 INFO NettyBlockTransferService: Server created on 192.168.11.7:51086
21/01/31 13:41:12 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
21/01/31 13:41:12 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(6, 192.168.11.7, 51086, None)
21/01/31 13:41:12 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(6, 192.168.11.7, 51086, None)
21/01/31 13:41:12 INFO BlockManager: Initialized BlockManager: BlockManagerId(6, 192.168.11.7, 51086, None)
21/01/31 13:41:16 INFO CoarseGrainedExecutorBackend: Got assigned task 2
21/01/31 13:41:16 INFO CoarseGrainedExecutorBackend: Got assigned task 12
21/01/31 13:41:16 INFO Executor: Running task 11.0 in stage 1.0 (TID 12)
21/01/31 13:41:16 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
21/01/31 13:41:16 INFO Executor: Fetching spark://192.168.11.7:51030/jars/simple-project_2.12-1.0.jar with timestamp 1612068067341
21/01/31 13:41:16 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:51030 after 4 ms (0 ms spent in bootstraps)
21/01/31 13:41:16 INFO Utils: Fetching spark://192.168.11.7:51030/jars/simple-project_2.12-1.0.jar to /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-56526756-d62c-425a-9228-330d931c7738/executor-9a792b04-3b1c-4c86-9b27-dcff78b59c58/spark-86f13eb6-fa26-43c2-81f5-227ea24c65e3/fetchFileTemp6325550623741353043.tmp
21/01/31 13:41:16 INFO Utils: Copying /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-56526756-d62c-425a-9228-330d931c7738/executor-9a792b04-3b1c-4c86-9b27-dcff78b59c58/spark-86f13eb6-fa26-43c2-81f5-227ea24c65e3/16839229251612068067341_cache to /Users/kinsho/workspace/spark-3.0.1/work/app-20210131134107-0030/6/./simple-project_2.12-1.0.jar
21/01/31 13:41:16 INFO Executor: Adding file:/Users/kinsho/workspace/spark-3.0.1/work/app-20210131134107-0030/6/./simple-project_2.12-1.0.jar to class loader
21/01/31 13:41:17 INFO TorrentBroadcast: Started reading broadcast variable 4 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 13:41:17 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:51096 after 3 ms (0 ms spent in bootstraps)
21/01/31 13:41:17 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 18.1 KiB, free 366.3 MiB)
21/01/31 13:41:17 INFO TorrentBroadcast: Reading broadcast variable 4 took 377 ms
21/01/31 13:41:17 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 43.3 KiB, free 366.2 MiB)
21/01/31 13:41:19 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 134217728-268435456, partition values: [empty row]
21/01/31 13:41:19 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 1476395008-1610612736, partition values: [empty row]
21/01/31 13:41:21 INFO CodeGenerator: Code generated in 1167.091939 ms
21/01/31 13:41:21 INFO TorrentBroadcast: Started reading broadcast variable 3 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 13:41:21 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 24.0 KiB, free 366.2 MiB)
21/01/31 13:41:21 INFO TorrentBroadcast: Reading broadcast variable 3 took 13 ms
21/01/31 13:41:21 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 336.8 KiB, free 365.9 MiB)
21/01/31 13:41:50 INFO MemoryStore: Will not store rdd_12_11
21/01/31 13:41:50 WARN MemoryStore: Not enough space to cache rdd_12_11 in memory! (computed 135.8 MiB so far)
21/01/31 13:41:50 INFO MemoryStore: Memory use = 422.1 KiB (blocks) + 310.3 MiB (scratch space shared across 2 tasks(s)) = 310.7 MiB. Storage limit = 366.3 MiB.
21/01/31 13:41:50 WARN BlockManager: Persisting block rdd_12_11 to disk instead.
21/01/31 13:41:55 INFO MemoryStore: Block rdd_12_1 stored as values in memory (estimated size 164.0 MiB, free 201.9 MiB)
21/01/31 13:41:55 INFO CodeGenerator: Code generated in 8.150508 ms
21/01/31 13:41:55 INFO CodeGenerator: Code generated in 50.408274 ms
21/01/31 13:41:55 INFO CodeGenerator: Code generated in 53.195667 ms
21/01/31 13:41:55 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 2151 bytes result sent to driver
21/01/31 13:41:55 INFO CoarseGrainedExecutorBackend: Got assigned task 25
21/01/31 13:41:55 INFO Executor: Running task 24.0 in stage 1.0 (TID 25)
21/01/31 13:41:55 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 3221225472-3355443200, partition values: [empty row]
21/01/31 13:42:01 INFO MemoryStore: Will not store rdd_12_11
21/01/31 13:42:01 WARN MemoryStore: Not enough space to cache rdd_12_11 in memory! (computed 135.8 MiB so far)
21/01/31 13:42:01 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 106.7 MiB (scratch space shared across 2 tasks(s)) = 271.1 MiB. Storage limit = 366.3 MiB.
21/01/31 13:42:01 INFO Executor: Finished task 11.0 in stage 1.0 (TID 12). 2108 bytes result sent to driver
21/01/31 13:42:01 INFO CoarseGrainedExecutorBackend: Got assigned task 37
21/01/31 13:42:01 INFO Executor: Running task 36.0 in stage 1.0 (TID 37)
21/01/31 13:42:01 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 4831838208-4966055936, partition values: [empty row]
21/01/31 13:42:14 INFO MemoryStore: Will not store rdd_12_36
21/01/31 13:42:14 WARN MemoryStore: Not enough space to cache rdd_12_36 in memory! (computed 69.1 MiB so far)
21/01/31 13:42:14 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 156.8 MiB (scratch space shared across 2 tasks(s)) = 321.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:42:14 WARN BlockManager: Persisting block rdd_12_36 to disk instead.
21/01/31 13:42:21 INFO MemoryStore: Will not store rdd_12_24
21/01/31 13:42:21 WARN MemoryStore: Not enough space to cache rdd_12_24 in memory! (computed 135.7 MiB so far)
21/01/31 13:42:21 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 103.6 MiB (scratch space shared across 1 tasks(s)) = 268.0 MiB. Storage limit = 366.3 MiB.
21/01/31 13:42:21 WARN BlockManager: Persisting block rdd_12_24 to disk instead.
21/01/31 13:42:31 INFO MemoryStore: Will not store rdd_12_24
21/01/31 13:42:31 WARN MemoryStore: Not enough space to cache rdd_12_24 in memory! (computed 135.7 MiB so far)
21/01/31 13:42:31 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 103.6 MiB (scratch space shared across 1 tasks(s)) = 268.0 MiB. Storage limit = 366.3 MiB.
21/01/31 13:42:31 INFO Executor: Finished task 24.0 in stage 1.0 (TID 25). 2108 bytes result sent to driver
21/01/31 13:42:31 INFO CoarseGrainedExecutorBackend: Got assigned task 46
21/01/31 13:42:31 INFO Executor: Running task 45.0 in stage 1.0 (TID 46)
21/01/31 13:42:31 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 6039797760-6174015488, partition values: [empty row]
21/01/31 13:42:36 INFO MemoryStore: Will not store rdd_12_36
21/01/31 13:42:36 WARN MemoryStore: Not enough space to cache rdd_12_36 in memory! (computed 136.2 MiB so far)
21/01/31 13:42:36 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 106.8 MiB (scratch space shared across 2 tasks(s)) = 271.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:42:36 INFO Executor: Finished task 36.0 in stage 1.0 (TID 37). 2108 bytes result sent to driver
21/01/31 13:42:36 INFO CoarseGrainedExecutorBackend: Got assigned task 60
21/01/31 13:42:36 INFO Executor: Running task 59.0 in stage 1.0 (TID 60)
21/01/31 13:42:36 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 7918845952-8053063680, partition values: [empty row]
21/01/31 13:42:48 INFO MemoryStore: Will not store rdd_12_59
21/01/31 13:42:48 WARN MemoryStore: Not enough space to cache rdd_12_59 in memory! (computed 69.8 MiB so far)
21/01/31 13:42:48 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 157.5 MiB (scratch space shared across 2 tasks(s)) = 321.8 MiB. Storage limit = 366.3 MiB.
21/01/31 13:42:48 WARN BlockManager: Persisting block rdd_12_59 to disk instead.
21/01/31 13:42:57 INFO MemoryStore: Will not store rdd_12_45
21/01/31 13:42:57 WARN MemoryStore: Not enough space to cache rdd_12_45 in memory! (computed 136.4 MiB so far)
21/01/31 13:42:57 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 103.5 MiB (scratch space shared across 1 tasks(s)) = 267.9 MiB. Storage limit = 366.3 MiB.
21/01/31 13:42:57 WARN BlockManager: Persisting block rdd_12_45 to disk instead.
21/01/31 13:43:03 INFO MemoryStore: Will not store rdd_12_45
21/01/31 13:43:04 WARN MemoryStore: Not enough space to cache rdd_12_45 in memory! (computed 136.4 MiB so far)
21/01/31 13:43:04 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 103.5 MiB (scratch space shared across 1 tasks(s)) = 267.9 MiB. Storage limit = 366.3 MiB.
21/01/31 13:43:04 INFO Executor: Finished task 45.0 in stage 1.0 (TID 46). 2108 bytes result sent to driver
21/01/31 13:43:04 INFO CoarseGrainedExecutorBackend: Got assigned task 67
21/01/31 13:43:04 INFO Executor: Running task 66.0 in stage 1.0 (TID 67)
21/01/31 13:43:04 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 8858370048-8992587776, partition values: [empty row]
21/01/31 13:43:08 INFO MemoryStore: Will not store rdd_12_59
21/01/31 13:43:08 WARN MemoryStore: Not enough space to cache rdd_12_59 in memory! (computed 135.5 MiB so far)
21/01/31 13:43:08 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 108.0 MiB (scratch space shared across 2 tasks(s)) = 272.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:43:08 INFO Executor: Finished task 59.0 in stage 1.0 (TID 60). 2108 bytes result sent to driver
21/01/31 13:43:08 INFO CoarseGrainedExecutorBackend: Got assigned task 80
21/01/31 13:43:08 INFO Executor: Running task 79.0 in stage 1.0 (TID 80)
21/01/31 13:43:08 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 10603200512-10737418240, partition values: [empty row]
21/01/31 13:43:21 INFO MemoryStore: Will not store rdd_12_79
21/01/31 13:43:21 WARN MemoryStore: Not enough space to cache rdd_12_79 in memory! (computed 69.0 MiB so far)
21/01/31 13:43:21 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 159.2 MiB (scratch space shared across 2 tasks(s)) = 323.6 MiB. Storage limit = 366.3 MiB.
21/01/31 13:43:21 WARN BlockManager: Persisting block rdd_12_79 to disk instead.
21/01/31 13:43:29 INFO MemoryStore: Will not store rdd_12_66
21/01/31 13:43:29 WARN MemoryStore: Not enough space to cache rdd_12_66 in memory! (computed 137.5 MiB so far)
21/01/31 13:43:29 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 104.4 MiB (scratch space shared across 1 tasks(s)) = 268.8 MiB. Storage limit = 366.3 MiB.
21/01/31 13:43:29 WARN BlockManager: Persisting block rdd_12_66 to disk instead.
21/01/31 13:43:35 INFO MemoryStore: Will not store rdd_12_66
21/01/31 13:43:35 WARN MemoryStore: Not enough space to cache rdd_12_66 in memory! (computed 137.5 MiB so far)
21/01/31 13:43:35 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 104.4 MiB (scratch space shared across 1 tasks(s)) = 268.8 MiB. Storage limit = 366.3 MiB.
21/01/31 13:43:35 INFO Executor: Finished task 66.0 in stage 1.0 (TID 67). 2108 bytes result sent to driver
21/01/31 13:43:35 INFO CoarseGrainedExecutorBackend: Got assigned task 87
21/01/31 13:43:35 INFO Executor: Running task 86.0 in stage 1.0 (TID 87)
21/01/31 13:43:35 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 11542724608-11676942336, partition values: [empty row]
21/01/31 13:43:40 INFO MemoryStore: Will not store rdd_12_79
21/01/31 13:43:40 WARN MemoryStore: Not enough space to cache rdd_12_79 in memory! (computed 135.2 MiB so far)
21/01/31 13:43:40 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 106.8 MiB (scratch space shared across 2 tasks(s)) = 271.1 MiB. Storage limit = 366.3 MiB.
21/01/31 13:43:41 INFO Executor: Finished task 79.0 in stage 1.0 (TID 80). 2108 bytes result sent to driver
21/01/31 13:43:41 INFO CoarseGrainedExecutorBackend: Got assigned task 100
21/01/31 13:43:41 INFO Executor: Running task 99.0 in stage 1.0 (TID 100)
21/01/31 13:43:41 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 13287555072-13421772800, partition values: [empty row]
21/01/31 13:43:53 INFO MemoryStore: Will not store rdd_12_99
21/01/31 13:43:53 WARN MemoryStore: Not enough space to cache rdd_12_99 in memory! (computed 67.2 MiB so far)
21/01/31 13:43:53 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 157.4 MiB (scratch space shared across 2 tasks(s)) = 321.8 MiB. Storage limit = 366.3 MiB.
21/01/31 13:43:53 WARN BlockManager: Persisting block rdd_12_99 to disk instead.
21/01/31 13:44:01 INFO MemoryStore: Will not store rdd_12_86
21/01/31 13:44:01 WARN MemoryStore: Not enough space to cache rdd_12_86 in memory! (computed 135.0 MiB so far)
21/01/31 13:44:01 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 105.7 MiB (scratch space shared across 1 tasks(s)) = 270.0 MiB. Storage limit = 366.3 MiB.
21/01/31 13:44:01 WARN BlockManager: Persisting block rdd_12_86 to disk instead.
21/01/31 13:44:06 INFO MemoryStore: Will not store rdd_12_86
21/01/31 13:44:06 WARN MemoryStore: Not enough space to cache rdd_12_86 in memory! (computed 135.0 MiB so far)
21/01/31 13:44:06 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 105.7 MiB (scratch space shared across 1 tasks(s)) = 270.0 MiB. Storage limit = 366.3 MiB.
21/01/31 13:44:07 INFO Executor: Finished task 86.0 in stage 1.0 (TID 87). 2108 bytes result sent to driver
21/01/31 13:44:07 INFO CoarseGrainedExecutorBackend: Got assigned task 109
21/01/31 13:44:07 INFO Executor: Running task 108.0 in stage 1.0 (TID 109)
21/01/31 13:44:07 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 14495514624-14629732352, partition values: [empty row]
21/01/31 13:44:13 INFO MemoryStore: Will not store rdd_12_99
21/01/31 13:44:13 WARN MemoryStore: Not enough space to cache rdd_12_99 in memory! (computed 133.9 MiB so far)
21/01/31 13:44:13 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 103.8 MiB (scratch space shared across 2 tasks(s)) = 268.1 MiB. Storage limit = 366.3 MiB.
21/01/31 13:44:13 INFO Executor: Finished task 99.0 in stage 1.0 (TID 100). 2108 bytes result sent to driver
21/01/31 13:44:13 INFO CoarseGrainedExecutorBackend: Got assigned task 120
21/01/31 13:44:13 INFO Executor: Running task 119.0 in stage 1.0 (TID 120)
21/01/31 13:44:13 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 15971909632-16106127360, partition values: [empty row]
21/01/31 13:44:26 INFO MemoryStore: Will not store rdd_12_119
21/01/31 13:44:26 WARN MemoryStore: Not enough space to cache rdd_12_119 in memory! (computed 68.9 MiB so far)
21/01/31 13:44:26 INFO MemoryStore: Memory use = 164.4 MiB (blocks) + 155.1 MiB (scratch space shared across 2 tasks(s)) = 319.5 MiB. Storage limit = 366.3 MiB.
21/01/31 13:44:26 WARN BlockManager: Persisting block rdd_12_119 to disk instead.
21/01/31 13:44:36 INFO MemoryStore: Block rdd_12_108 stored as values in memory (estimated size 153.6 MiB, free 48.4 MiB)
21/01/31 13:44:36 INFO Executor: Finished task 108.0 in stage 1.0 (TID 109). 2108 bytes result sent to driver
21/01/31 13:44:36 INFO CoarseGrainedExecutorBackend: Got assigned task 125
21/01/31 13:44:36 INFO Executor: Running task 124.0 in stage 1.0 (TID 125)
21/01/31 13:44:36 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 16642998272-16777216000, partition values: [empty row]
21/01/31 13:44:43 INFO MemoryStore: Will not store rdd_12_124
21/01/31 13:44:43 WARN MemoryStore: Not enough space to cache rdd_12_124 in memory! (computed 35.0 MiB so far)
21/01/31 13:44:43 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.1 MiB (scratch space shared across 1 tasks(s)) = 321.0 MiB. Storage limit = 366.3 MiB.
21/01/31 13:44:43 WARN BlockManager: Persisting block rdd_12_124 to disk instead.
21/01/31 13:44:44 INFO MemoryStore: Will not store rdd_12_119
21/01/31 13:44:44 WARN MemoryStore: Not enough space to cache rdd_12_119 in memory! (computed 35.3 MiB so far)
21/01/31 13:44:44 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.0 MiB (scratch space shared across 1 tasks(s)) = 320.9 MiB. Storage limit = 366.3 MiB.
21/01/31 13:44:44 INFO Executor: Finished task 119.0 in stage 1.0 (TID 120). 2108 bytes result sent to driver
21/01/31 13:44:44 INFO CoarseGrainedExecutorBackend: Got assigned task 140
21/01/31 13:44:44 INFO Executor: Running task 139.0 in stage 1.0 (TID 140)
21/01/31 13:44:44 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 18656264192-18790481920, partition values: [empty row]
21/01/31 13:44:51 INFO MemoryStore: Will not store rdd_12_139
21/01/31 13:44:51 WARN MemoryStore: Not enough space to cache rdd_12_139 in memory! (computed 36.2 MiB so far)
21/01/31 13:44:51 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.1 MiB (scratch space shared across 1 tasks(s)) = 321.1 MiB. Storage limit = 366.3 MiB.
21/01/31 13:44:51 WARN BlockManager: Persisting block rdd_12_139 to disk instead.
21/01/31 13:45:08 INFO MemoryStore: Will not store rdd_12_124
21/01/31 13:45:08 WARN MemoryStore: Not enough space to cache rdd_12_124 in memory! (computed 35.0 MiB so far)
21/01/31 13:45:08 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.1 MiB (scratch space shared across 1 tasks(s)) = 321.0 MiB. Storage limit = 366.3 MiB.
21/01/31 13:45:08 INFO Executor: Finished task 124.0 in stage 1.0 (TID 125). 2108 bytes result sent to driver
21/01/31 13:45:08 INFO CoarseGrainedExecutorBackend: Got assigned task 147
21/01/31 13:45:08 INFO Executor: Running task 146.0 in stage 1.0 (TID 147)
21/01/31 13:45:08 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 19595788288-19730006016, partition values: [empty row]
21/01/31 13:45:15 INFO MemoryStore: Will not store rdd_12_139
21/01/31 13:45:15 WARN MemoryStore: Not enough space to cache rdd_12_139 in memory! (computed 36.2 MiB so far)
21/01/31 13:45:15 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 6.3 MiB (scratch space shared across 2 tasks(s)) = 324.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:45:16 INFO Executor: Finished task 139.0 in stage 1.0 (TID 140). 2108 bytes result sent to driver
21/01/31 13:45:16 INFO CoarseGrainedExecutorBackend: Got assigned task 160
21/01/31 13:45:16 INFO Executor: Running task 159.0 in stage 1.0 (TID 160)
21/01/31 13:45:16 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 21340618752-21474836480, partition values: [empty row]
21/01/31 13:45:16 INFO MemoryStore: Will not store rdd_12_146
21/01/31 13:45:16 WARN MemoryStore: Not enough space to cache rdd_12_146 in memory! (computed 36.4 MiB so far)
21/01/31 13:45:16 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 4.2 MiB (scratch space shared across 2 tasks(s)) = 322.1 MiB. Storage limit = 366.3 MiB.
21/01/31 13:45:16 WARN BlockManager: Persisting block rdd_12_146 to disk instead.
21/01/31 13:45:23 INFO MemoryStore: Will not store rdd_12_159
21/01/31 13:45:23 WARN MemoryStore: Not enough space to cache rdd_12_159 in memory! (computed 37.5 MiB so far)
21/01/31 13:45:23 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.3 MiB (scratch space shared across 1 tasks(s)) = 321.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:45:23 WARN BlockManager: Persisting block rdd_12_159 to disk instead.
21/01/31 13:45:40 INFO MemoryStore: Will not store rdd_12_146
21/01/31 13:45:40 WARN MemoryStore: Not enough space to cache rdd_12_146 in memory! (computed 36.4 MiB so far)
21/01/31 13:45:40 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.2 MiB (scratch space shared across 1 tasks(s)) = 321.1 MiB. Storage limit = 366.3 MiB.
21/01/31 13:45:40 INFO Executor: Finished task 146.0 in stage 1.0 (TID 147). 2108 bytes result sent to driver
21/01/31 13:45:40 INFO CoarseGrainedExecutorBackend: Got assigned task 171
21/01/31 13:45:40 INFO Executor: Running task 170.0 in stage 1.0 (TID 171)
21/01/31 13:45:40 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 22817013760-22951231488, partition values: [empty row]
21/01/31 13:45:46 INFO MemoryStore: Will not store rdd_12_159
21/01/31 13:45:46 WARN MemoryStore: Not enough space to cache rdd_12_159 in memory! (computed 37.5 MiB so far)
21/01/31 13:45:46 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 6.6 MiB (scratch space shared across 2 tasks(s)) = 324.5 MiB. Storage limit = 366.3 MiB.
21/01/31 13:45:46 INFO Executor: Finished task 159.0 in stage 1.0 (TID 160). 2108 bytes result sent to driver
21/01/31 13:45:47 INFO MemoryStore: Will not store rdd_12_170
21/01/31 13:45:47 WARN MemoryStore: Not enough space to cache rdd_12_170 in memory! (computed 37.3 MiB so far)
21/01/31 13:45:47 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.3 MiB (scratch space shared across 1 tasks(s)) = 321.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:45:47 WARN BlockManager: Persisting block rdd_12_170 to disk instead.
21/01/31 13:46:03 INFO MemoryStore: Will not store rdd_12_170
21/01/31 13:46:03 WARN MemoryStore: Not enough space to cache rdd_12_170 in memory! (computed 37.3 MiB so far)
21/01/31 13:46:03 INFO MemoryStore: Memory use = 317.9 MiB (blocks) + 3.3 MiB (scratch space shared across 1 tasks(s)) = 321.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:04 INFO Executor: Finished task 170.0 in stage 1.0 (TID 171). 2108 bytes result sent to driver
21/01/31 13:46:04 INFO CoarseGrainedExecutorBackend: Got assigned task 181
21/01/31 13:46:04 INFO CoarseGrainedExecutorBackend: Got assigned task 191
21/01/31 13:46:04 INFO Executor: Running task 1.0 in stage 3.0 (TID 181)
21/01/31 13:46:04 INFO Executor: Running task 11.0 in stage 3.0 (TID 191)
21/01/31 13:46:04 INFO MapOutputTrackerWorker: Updating epoch to 1 and clearing cache
21/01/31 13:46:04 INFO TorrentBroadcast: Started reading broadcast variable 6 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 13:46:04 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:51036 after 3 ms (0 ms spent in bootstraps)
21/01/31 13:46:04 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 69.4 KiB, free 48.3 MiB)
21/01/31 13:46:05 INFO TorrentBroadcast: Reading broadcast variable 6 took 46 ms
21/01/31 13:46:05 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 194.6 KiB, free 48.1 MiB)
21/01/31 13:46:05 INFO BlockManager: Found block rdd_12_1 locally
21/01/31 13:46:05 INFO MemoryStore: Will not store rdd_12_11
21/01/31 13:46:05 WARN MemoryStore: Not enough space to cache rdd_12_11 in memory! (computed 35.6 MiB so far)
21/01/31 13:46:05 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.1 MiB (scratch space shared across 1 tasks(s)) = 321.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:05 INFO BlockManager: Found block rdd_12_11 locally
21/01/31 13:46:05 INFO CodeGenerator: Code generated in 248.549799 ms
21/01/31 13:46:05 INFO CodeGenerator: Code generated in 35.49682 ms
21/01/31 13:46:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:05 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:05 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:05 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:05 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:05 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:05 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:05 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:05 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:05 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:05 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:05 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:05 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:05 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:05 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:05 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:05 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:05 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:05 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:05 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:05 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:05 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:05 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:05 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:05 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:05 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:05 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:05 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:05 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:05 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:06 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:46:06 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:46:06 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 13:46:06 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 13:46:16 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37907071
21/01/31 13:46:17 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000001_181' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000001
21/01/31 13:46:17 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000001_181: Committed
21/01/31 13:46:17 INFO Executor: Finished task 1.0 in stage 3.0 (TID 181). 2504 bytes result sent to driver
21/01/31 13:46:17 INFO CoarseGrainedExecutorBackend: Got assigned task 199
21/01/31 13:46:17 INFO Executor: Running task 24.0 in stage 3.0 (TID 199)
21/01/31 13:46:17 INFO MemoryStore: Will not store rdd_12_24
21/01/31 13:46:17 WARN MemoryStore: Not enough space to cache rdd_12_24 in memory! (computed 35.5 MiB so far)
21/01/31 13:46:17 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.1 MiB (scratch space shared across 1 tasks(s)) = 321.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:17 INFO BlockManager: Found block rdd_12_24 locally
21/01/31 13:46:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:17 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:17 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:17 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:17 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:17 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:17 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:17 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:17 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:17 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:17 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:17 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:17 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:17 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:17 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:17 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:17 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:46:18 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 40739463
21/01/31 13:46:18 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000011_191' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000011
21/01/31 13:46:18 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000011_191: Committed
21/01/31 13:46:18 INFO Executor: Finished task 11.0 in stage 3.0 (TID 191). 2461 bytes result sent to driver
21/01/31 13:46:18 INFO CoarseGrainedExecutorBackend: Got assigned task 206
21/01/31 13:46:18 INFO Executor: Running task 36.0 in stage 3.0 (TID 206)
21/01/31 13:46:19 INFO MemoryStore: Will not store rdd_12_36
21/01/31 13:46:19 WARN MemoryStore: Not enough space to cache rdd_12_36 in memory! (computed 35.5 MiB so far)
21/01/31 13:46:19 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 6.2 MiB (scratch space shared across 2 tasks(s)) = 324.4 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:19 INFO BlockManager: Found block rdd_12_36 locally
21/01/31 13:46:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:19 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:19 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:19 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:19 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:19 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:19 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:19 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:19 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:19 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:19 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:19 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:19 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:19 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:19 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:19 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:46:34 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 41046304
21/01/31 13:46:35 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000024_199' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000024
21/01/31 13:46:35 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000024_199: Committed
21/01/31 13:46:35 INFO Executor: Finished task 24.0 in stage 3.0 (TID 199). 2461 bytes result sent to driver
21/01/31 13:46:35 INFO CoarseGrainedExecutorBackend: Got assigned task 226
21/01/31 13:46:35 INFO Executor: Running task 45.0 in stage 3.0 (TID 226)
21/01/31 13:46:35 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 39644904
21/01/31 13:46:35 INFO MemoryStore: Will not store rdd_12_45
21/01/31 13:46:35 WARN MemoryStore: Not enough space to cache rdd_12_45 in memory! (computed 35.5 MiB so far)
21/01/31 13:46:35 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.2 MiB (scratch space shared across 1 tasks(s)) = 321.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:35 INFO BlockManager: Found block rdd_12_45 locally
21/01/31 13:46:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:35 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:35 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:35 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:35 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:35 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:35 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:35 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:35 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:35 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:35 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:35 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:35 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:35 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:35 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:35 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:46:36 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000036_206' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000036
21/01/31 13:46:36 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000036_206: Committed
21/01/31 13:46:36 INFO Executor: Finished task 36.0 in stage 3.0 (TID 206). 2461 bytes result sent to driver
21/01/31 13:46:36 INFO CoarseGrainedExecutorBackend: Got assigned task 227
21/01/31 13:46:36 INFO Executor: Running task 59.0 in stage 3.0 (TID 227)
21/01/31 13:46:36 INFO MemoryStore: Will not store rdd_12_59
21/01/31 13:46:36 WARN MemoryStore: Not enough space to cache rdd_12_59 in memory! (computed 36.0 MiB so far)
21/01/31 13:46:36 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 6.3 MiB (scratch space shared across 2 tasks(s)) = 324.4 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:36 INFO BlockManager: Found block rdd_12_59 locally
21/01/31 13:46:36 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:36 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:36 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:36 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:36 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:36 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:36 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:36 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:36 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:36 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:36 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:36 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:36 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:36 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:36 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:36 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:36 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:46:51 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 38686569
21/01/31 13:46:51 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37515918
21/01/31 13:46:52 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000045_226' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000045
21/01/31 13:46:52 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000045_226: Committed
21/01/31 13:46:52 INFO Executor: Finished task 45.0 in stage 3.0 (TID 226). 2461 bytes result sent to driver
21/01/31 13:46:52 INFO CoarseGrainedExecutorBackend: Got assigned task 235
21/01/31 13:46:52 INFO Executor: Running task 66.0 in stage 3.0 (TID 235)
21/01/31 13:46:52 INFO MemoryStore: Will not store rdd_12_66
21/01/31 13:46:52 WARN MemoryStore: Not enough space to cache rdd_12_66 in memory! (computed 35.6 MiB so far)
21/01/31 13:46:52 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.2 MiB (scratch space shared across 1 tasks(s)) = 321.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:52 INFO BlockManager: Found block rdd_12_66 locally
21/01/31 13:46:52 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:52 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:52 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:52 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:52 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:52 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:52 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:52 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:52 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:52 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:52 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:52 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:52 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:52 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:52 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:52 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:52 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:46:52 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000059_227' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000059
21/01/31 13:46:52 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000059_227: Committed
21/01/31 13:46:52 INFO Executor: Finished task 59.0 in stage 3.0 (TID 227). 2461 bytes result sent to driver
21/01/31 13:46:52 INFO CoarseGrainedExecutorBackend: Got assigned task 236
21/01/31 13:46:52 INFO Executor: Running task 79.0 in stage 3.0 (TID 236)
21/01/31 13:46:52 INFO MemoryStore: Will not store rdd_12_79
21/01/31 13:46:52 WARN MemoryStore: Not enough space to cache rdd_12_79 in memory! (computed 36.5 MiB so far)
21/01/31 13:46:52 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 6.5 MiB (scratch space shared across 2 tasks(s)) = 324.7 MiB. Storage limit = 366.3 MiB.
21/01/31 13:46:52 INFO BlockManager: Found block rdd_12_79 locally
21/01/31 13:46:52 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:52 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:52 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:46:52 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:46:52 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:52 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:46:52 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:46:52 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:46:52 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:46:52 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:46:52 INFO ParquetOutputFormat: Validation is off
21/01/31 13:46:52 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:46:52 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:46:52 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:46:52 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:46:52 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:46:52 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:07 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37011592
21/01/31 13:47:07 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35950552
21/01/31 13:47:08 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000066_235' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000066
21/01/31 13:47:08 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000066_235: Committed
21/01/31 13:47:08 INFO Executor: Finished task 66.0 in stage 3.0 (TID 235). 2461 bytes result sent to driver
21/01/31 13:47:08 INFO CoarseGrainedExecutorBackend: Got assigned task 247
21/01/31 13:47:08 INFO Executor: Running task 86.0 in stage 3.0 (TID 247)
21/01/31 13:47:08 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000079_236' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000079
21/01/31 13:47:08 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000079_236: Committed
21/01/31 13:47:08 INFO Executor: Finished task 79.0 in stage 3.0 (TID 236). 2461 bytes result sent to driver
21/01/31 13:47:08 INFO CoarseGrainedExecutorBackend: Got assigned task 248
21/01/31 13:47:08 INFO MemoryStore: Will not store rdd_12_86
21/01/31 13:47:08 INFO Executor: Running task 99.0 in stage 3.0 (TID 248)
21/01/31 13:47:08 WARN MemoryStore: Not enough space to cache rdd_12_86 in memory! (computed 36.5 MiB so far)
21/01/31 13:47:08 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.2 MiB (scratch space shared across 1 tasks(s)) = 321.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:47:08 INFO BlockManager: Found block rdd_12_86 locally
21/01/31 13:47:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:08 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:08 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:08 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:08 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:08 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:08 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:08 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:08 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:08 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:08 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:08 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:08 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:08 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:08 INFO MemoryStore: Will not store rdd_12_99
21/01/31 13:47:08 WARN MemoryStore: Not enough space to cache rdd_12_99 in memory! (computed 34.5 MiB so far)
21/01/31 13:47:08 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 6.3 MiB (scratch space shared across 2 tasks(s)) = 324.5 MiB. Storage limit = 366.3 MiB.
21/01/31 13:47:08 INFO BlockManager: Found block rdd_12_99 locally
21/01/31 13:47:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:08 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:08 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:08 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:08 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:08 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:08 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:08 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:08 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:08 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:08 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:08 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:08 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:08 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:21 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35946419
21/01/31 13:47:21 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35930678
21/01/31 13:47:22 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000086_247' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000086
21/01/31 13:47:22 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000086_247: Committed
21/01/31 13:47:22 INFO Executor: Finished task 86.0 in stage 3.0 (TID 247). 2461 bytes result sent to driver
21/01/31 13:47:22 INFO CoarseGrainedExecutorBackend: Got assigned task 260
21/01/31 13:47:22 INFO Executor: Running task 108.0 in stage 3.0 (TID 260)
21/01/31 13:47:22 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000099_248' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000099
21/01/31 13:47:22 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000099_248: Committed
21/01/31 13:47:22 INFO Executor: Finished task 99.0 in stage 3.0 (TID 248). 2461 bytes result sent to driver
21/01/31 13:47:22 INFO CoarseGrainedExecutorBackend: Got assigned task 261
21/01/31 13:47:22 INFO Executor: Running task 119.0 in stage 3.0 (TID 261)
21/01/31 13:47:22 INFO BlockManager: Found block rdd_12_108 locally
21/01/31 13:47:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:22 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:22 INFO MemoryStore: Will not store rdd_12_119
21/01/31 13:47:22 WARN MemoryStore: Not enough space to cache rdd_12_119 in memory! (computed 35.3 MiB so far)
21/01/31 13:47:22 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.0 MiB (scratch space shared across 1 tasks(s)) = 321.1 MiB. Storage limit = 366.3 MiB.
21/01/31 13:47:22 INFO BlockManager: Found block rdd_12_119 locally
21/01/31 13:47:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:22 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:33 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35192352
21/01/31 13:47:34 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35227785
21/01/31 13:47:34 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000108_260' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000108
21/01/31 13:47:34 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000108_260: Committed
21/01/31 13:47:34 INFO Executor: Finished task 108.0 in stage 3.0 (TID 260). 2461 bytes result sent to driver
21/01/31 13:47:34 INFO CoarseGrainedExecutorBackend: Got assigned task 276
21/01/31 13:47:34 INFO Executor: Running task 124.0 in stage 3.0 (TID 276)
21/01/31 13:47:34 INFO MemoryStore: Will not store rdd_12_124
21/01/31 13:47:34 WARN MemoryStore: Not enough space to cache rdd_12_124 in memory! (computed 35.0 MiB so far)
21/01/31 13:47:34 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.1 MiB (scratch space shared across 1 tasks(s)) = 321.2 MiB. Storage limit = 366.3 MiB.
21/01/31 13:47:34 INFO BlockManager: Found block rdd_12_124 locally
21/01/31 13:47:34 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:34 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:34 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:34 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:34 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:34 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:34 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:34 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:34 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:34 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:34 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:34 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:34 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:34 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:34 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:34 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:34 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:34 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000119_261' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000119
21/01/31 13:47:34 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000119_261: Committed
21/01/31 13:47:34 INFO Executor: Finished task 119.0 in stage 3.0 (TID 261). 2461 bytes result sent to driver
21/01/31 13:47:34 INFO CoarseGrainedExecutorBackend: Got assigned task 277
21/01/31 13:47:34 INFO Executor: Running task 139.0 in stage 3.0 (TID 277)
21/01/31 13:47:35 INFO MemoryStore: Will not store rdd_12_139
21/01/31 13:47:35 WARN MemoryStore: Not enough space to cache rdd_12_139 in memory! (computed 36.2 MiB so far)
21/01/31 13:47:35 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 6.2 MiB (scratch space shared across 2 tasks(s)) = 324.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:47:35 INFO BlockManager: Found block rdd_12_139 locally
21/01/31 13:47:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:35 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:35 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:35 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:35 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:35 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:35 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:35 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:35 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:35 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:35 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:35 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:35 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:35 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:35 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:35 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:35 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:47 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35476460
21/01/31 13:47:47 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35134266
21/01/31 13:47:47 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000124_276' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000124
21/01/31 13:47:47 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000124_276: Committed
21/01/31 13:47:47 INFO Executor: Finished task 124.0 in stage 3.0 (TID 276). 2461 bytes result sent to driver
21/01/31 13:47:47 INFO CoarseGrainedExecutorBackend: Got assigned task 293
21/01/31 13:47:47 INFO Executor: Running task 146.0 in stage 3.0 (TID 293)
21/01/31 13:47:47 INFO MemoryStore: Will not store rdd_12_146
21/01/31 13:47:47 WARN MemoryStore: Not enough space to cache rdd_12_146 in memory! (computed 36.4 MiB so far)
21/01/31 13:47:47 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.2 MiB (scratch space shared across 1 tasks(s)) = 321.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:47:47 INFO BlockManager: Found block rdd_12_146 locally
21/01/31 13:47:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:47 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:47 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:47 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:47 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:47 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:47 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:47 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:47 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:47 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:47 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:47 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:47 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:47 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:48 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000139_277' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000139
21/01/31 13:47:48 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000139_277: Committed
21/01/31 13:47:48 INFO Executor: Finished task 139.0 in stage 3.0 (TID 277). 2461 bytes result sent to driver
21/01/31 13:47:48 INFO CoarseGrainedExecutorBackend: Got assigned task 294
21/01/31 13:47:48 INFO Executor: Running task 159.0 in stage 3.0 (TID 294)
21/01/31 13:47:48 INFO MemoryStore: Will not store rdd_12_159
21/01/31 13:47:48 WARN MemoryStore: Not enough space to cache rdd_12_159 in memory! (computed 37.5 MiB so far)
21/01/31 13:47:48 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 6.4 MiB (scratch space shared across 2 tasks(s)) = 324.6 MiB. Storage limit = 366.3 MiB.
21/01/31 13:47:48 INFO BlockManager: Found block rdd_12_159 locally
21/01/31 13:47:48 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:48 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:48 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:47:48 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:47:48 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:48 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:47:48 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:47:48 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:47:48 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:47:48 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:47:48 INFO ParquetOutputFormat: Validation is off
21/01/31 13:47:48 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:47:48 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:47:48 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:47:48 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:47:48 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:47:48 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:47:59 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35872292
21/01/31 13:47:59 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35803468
21/01/31 13:48:00 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000159_294' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000159
21/01/31 13:48:00 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000159_294: Committed
21/01/31 13:48:00 INFO Executor: Finished task 159.0 in stage 3.0 (TID 294). 2461 bytes result sent to driver
21/01/31 13:48:00 INFO CoarseGrainedExecutorBackend: Got assigned task 311
21/01/31 13:48:00 INFO Executor: Running task 170.0 in stage 3.0 (TID 311)
21/01/31 13:48:00 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000146_293' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000146
21/01/31 13:48:00 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000146_293: Committed
21/01/31 13:48:00 INFO Executor: Finished task 146.0 in stage 3.0 (TID 293). 2461 bytes result sent to driver
21/01/31 13:48:00 INFO MemoryStore: Will not store rdd_12_170
21/01/31 13:48:00 WARN MemoryStore: Not enough space to cache rdd_12_170 in memory! (computed 37.3 MiB so far)
21/01/31 13:48:00 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.3 MiB (scratch space shared across 1 tasks(s)) = 321.4 MiB. Storage limit = 366.3 MiB.
21/01/31 13:48:00 INFO BlockManager: Found block rdd_12_170 locally
21/01/31 13:48:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:00 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:00 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:00 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:00 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:00 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:00 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:00 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:00 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:00 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:00 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:00 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:00 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:00 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:00 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:00 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:09 INFO CoarseGrainedExecutorBackend: Got assigned task 323
21/01/31 13:48:09 INFO Executor: Running task 68.0 in stage 3.0 (TID 323)
21/01/31 13:48:09 INFO BlockManager: Read rdd_12_68 from the disk of a same host executor is successful.
21/01/31 13:48:09 INFO BlockManager: Found block rdd_12_68 remotely
21/01/31 13:48:09 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:09 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:09 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:09 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:09 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:09 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:09 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:09 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:09 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:09 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:09 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:09 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:09 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:09 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:09 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:09 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:09 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:09 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 34831520
21/01/31 13:48:10 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000170_311' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000170
21/01/31 13:48:10 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000170_311: Committed
21/01/31 13:48:10 INFO Executor: Finished task 170.0 in stage 3.0 (TID 311). 2461 bytes result sent to driver
21/01/31 13:48:10 INFO CoarseGrainedExecutorBackend: Got assigned task 325
21/01/31 13:48:10 INFO Executor: Running task 71.0 in stage 3.0 (TID 325)
21/01/31 13:48:10 INFO BlockManager: Read rdd_12_71 from the disk of a same host executor is successful.
21/01/31 13:48:10 INFO BlockManager: Found block rdd_12_71 remotely
21/01/31 13:48:10 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:10 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:10 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:10 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:10 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:10 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:10 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:10 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:10 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:10 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:10 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:10 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:10 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:10 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:10 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:10 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:10 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:22 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36505987
21/01/31 13:48:23 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000068_323' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000068
21/01/31 13:48:23 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000068_323: Committed
21/01/31 13:48:23 INFO Executor: Finished task 68.0 in stage 3.0 (TID 323). 2461 bytes result sent to driver
21/01/31 13:48:23 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36880359
21/01/31 13:48:24 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000071_325' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000071
21/01/31 13:48:24 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000071_325: Committed
21/01/31 13:48:24 INFO Executor: Finished task 71.0 in stage 3.0 (TID 325). 2461 bytes result sent to driver
21/01/31 13:48:24 INFO CoarseGrainedExecutorBackend: Got assigned task 336
21/01/31 13:48:24 INFO CoarseGrainedExecutorBackend: Got assigned task 337
21/01/31 13:48:24 INFO Executor: Running task 95.0 in stage 3.0 (TID 336)
21/01/31 13:48:24 INFO Executor: Running task 96.0 in stage 3.0 (TID 337)
21/01/31 13:48:24 INFO BlockManager: Read rdd_12_96 from the disk of a same host executor is successful.
21/01/31 13:48:24 INFO BlockManager: Found block rdd_12_96 remotely
21/01/31 13:48:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:24 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:24 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:24 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:24 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:24 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:24 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:24 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:24 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:24 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:24 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:24 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:24 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:24 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:24 INFO BlockManager: Read rdd_12_95 from the disk of a same host executor is successful.
21/01/31 13:48:24 INFO BlockManager: Found block rdd_12_95 remotely
21/01/31 13:48:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:24 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:24 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:24 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:24 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:24 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:24 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:24 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:24 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:24 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:24 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:24 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:24 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:24 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:36 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35803052
21/01/31 13:48:36 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35098946
21/01/31 13:48:36 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000096_337' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000096
21/01/31 13:48:36 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000096_337: Committed
21/01/31 13:48:36 INFO Executor: Finished task 96.0 in stage 3.0 (TID 337). 2461 bytes result sent to driver
21/01/31 13:48:37 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000095_336' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000095
21/01/31 13:48:37 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000095_336: Committed
21/01/31 13:48:37 INFO Executor: Finished task 95.0 in stage 3.0 (TID 336). 2461 bytes result sent to driver
21/01/31 13:48:37 INFO CoarseGrainedExecutorBackend: Got assigned task 350
21/01/31 13:48:37 INFO CoarseGrainedExecutorBackend: Got assigned task 351
21/01/31 13:48:37 INFO Executor: Running task 58.1 in stage 3.0 (TID 351)
21/01/31 13:48:37 INFO Executor: Running task 33.2 in stage 3.0 (TID 350)
21/01/31 13:48:37 INFO BlockManager: Read rdd_12_58 from the disk of a same host executor is successful.
21/01/31 13:48:37 INFO BlockManager: Found block rdd_12_58 remotely
21/01/31 13:48:37 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:37 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:37 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:37 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:37 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:37 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:37 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:37 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:37 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:37 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:37 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:37 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:37 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:37 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:37 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:37 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:37 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:37 INFO BlockManager: Read rdd_12_33 from the disk of a same host executor is successful.
21/01/31 13:48:37 INFO BlockManager: Found block rdd_12_33 remotely
21/01/31 13:48:37 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:37 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:37 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:37 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:37 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:37 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:37 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:37 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:37 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:37 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:37 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:37 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:37 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:37 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:37 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:37 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:37 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:48 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37310227
21/01/31 13:48:49 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000058_351' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000058
21/01/31 13:48:49 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000058_351: Committed
21/01/31 13:48:49 INFO Executor: Finished task 58.1 in stage 3.0 (TID 351). 2461 bytes result sent to driver
21/01/31 13:48:49 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 39713466
21/01/31 13:48:50 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000033_350' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000033
21/01/31 13:48:50 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000033_350: Committed
21/01/31 13:48:50 INFO Executor: Finished task 33.2 in stage 3.0 (TID 350). 2461 bytes result sent to driver
21/01/31 13:48:50 INFO CoarseGrainedExecutorBackend: Got assigned task 366
21/01/31 13:48:50 INFO Executor: Running task 166.0 in stage 3.0 (TID 366)
21/01/31 13:48:50 INFO CoarseGrainedExecutorBackend: Got assigned task 367
21/01/31 13:48:50 INFO Executor: Running task 168.0 in stage 3.0 (TID 367)
21/01/31 13:48:50 INFO BlockManager: Read rdd_12_168 from the disk of a same host executor is successful.
21/01/31 13:48:50 INFO BlockManager: Found block rdd_12_168 remotely
21/01/31 13:48:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:50 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:50 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:50 INFO BlockManager: Read rdd_12_166 from the disk of a same host executor is successful.
21/01/31 13:48:50 INFO BlockManager: Found block rdd_12_166 remotely
21/01/31 13:48:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:50 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:50 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:48:50 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:48:50 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:50 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:50 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:50 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:50 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:50 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:50 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:50 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:50 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:50 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:50 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:50 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:50 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:50 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:50 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:48:50 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:48:50 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:48:50 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:48:50 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:48:50 INFO ParquetOutputFormat: Validation is off
21/01/31 13:48:50 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:48:50 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:48:50 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:48:50 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:48:50 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:48:50 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:48:58 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 34921270
21/01/31 13:48:59 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35294505
21/01/31 13:48:59 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000168_367' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000168
21/01/31 13:48:59 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000168_367: Committed
21/01/31 13:48:59 INFO Executor: Finished task 168.0 in stage 3.0 (TID 367). 2461 bytes result sent to driver
21/01/31 13:48:59 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000166_366' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000166
21/01/31 13:48:59 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000166_366: Committed
21/01/31 13:48:59 INFO Executor: Finished task 166.0 in stage 3.0 (TID 366). 2461 bytes result sent to driver
21/01/31 13:49:07 INFO CoarseGrainedExecutorBackend: Got assigned task 372
21/01/31 13:49:07 INFO Executor: Running task 64.1 in stage 3.0 (TID 372)
21/01/31 13:49:07 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 8589934592-8724152320, partition values: [empty row]
21/01/31 13:49:12 INFO MemoryStore: Will not store rdd_12_64
21/01/31 13:49:12 WARN MemoryStore: Not enough space to cache rdd_12_64 in memory! (computed 35.8 MiB so far)
21/01/31 13:49:12 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.2 MiB (scratch space shared across 1 tasks(s)) = 321.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:49:12 WARN BlockManager: Persisting block rdd_12_64 to disk instead.
21/01/31 13:49:24 INFO MemoryStore: Will not store rdd_12_64
21/01/31 13:49:24 WARN MemoryStore: Not enough space to cache rdd_12_64 in memory! (computed 35.8 MiB so far)
21/01/31 13:49:24 INFO MemoryStore: Memory use = 318.1 MiB (blocks) + 3.2 MiB (scratch space shared across 1 tasks(s)) = 321.3 MiB. Storage limit = 366.3 MiB.
21/01/31 13:49:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:49:24 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:49:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 13:49:24 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 13:49:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:49:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 13:49:24 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 13:49:24 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 13:49:24 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 13:49:24 INFO ParquetOutputFormat: Dictionary is on
21/01/31 13:49:24 INFO ParquetOutputFormat: Validation is off
21/01/31 13:49:24 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 13:49:24 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 13:49:24 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 13:49:24 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 13:49:24 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 13:49:24 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 13:49:27 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37569747
21/01/31 13:49:27 INFO FileOutputCommitter: Saved output of task 'attempt_20210131134604_0003_m_000064_372' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131134604_0003_m_000064
21/01/31 13:49:27 INFO SparkHadoopMapRedUtil: attempt_20210131134604_0003_m_000064_372: Committed
21/01/31 13:49:27 INFO Executor: Finished task 64.1 in stage 3.0 (TID 372). 2461 bytes result sent to driver
21/01/31 13:51:55 INFO CoarseGrainedExecutorBackend: Driver commanded a shutdown
