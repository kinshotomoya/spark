Spark Executor Command: "/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/bin/java" "-cp" "/Users/kinsho/workspace/spark-3.0.1/conf/:/Users/kinsho/workspace/spark-3.0.1/assembly/target/scala-2.12/jars/*" "-Xmx1024M" "-Dspark.driver.port=64981" "org.apache.spark.executor.CoarseGrainedExecutorBackend" "--driver-url" "spark://CoarseGrainedScheduler@192.168.11.7:64981" "--executor-id" "4" "--hostname" "192.168.11.7" "--cores" "2" "--app-id" "app-20210131150725-0034" "--worker-url" "spark://Worker@192.168.11.7:63978"
========================================

Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
21/01/31 15:07:27 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 30068@ST000000035
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for TERM
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for HUP
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for INT
21/01/31 15:07:28 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
21/01/31 15:07:28 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 15:07:28 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 15:07:28 INFO SecurityManager: Changing view acls groups to: 
21/01/31 15:07:28 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 15:07:28 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 15:07:29 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 158 ms (0 ms spent in bootstraps)
21/01/31 15:07:29 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 15:07:29 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 15:07:29 INFO SecurityManager: Changing view acls groups to: 
21/01/31 15:07:29 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 15:07:29 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 15:07:29 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:07:29 INFO DiskBlockManager: Created local directory at /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-fb50bbc1-385d-42b4-ab16-c5d025f6423b/executor-7267174c-0d59-4d62-8ba2-58f503363917/blockmgr-0a6762a1-2b05-4080-a2d9-ee09dc0a175e
21/01/31 15:07:30 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
21/01/31 15:07:30 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@192.168.11.7:64981
21/01/31 15:07:30 INFO WorkerWatcher: Connecting to worker spark://Worker@192.168.11.7:63978
21/01/31 15:07:30 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:63978 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:07:30 INFO WorkerWatcher: Successfully connected to spark://Worker@192.168.11.7:63978
21/01/31 15:07:30 INFO ResourceUtils: ==============================================================
21/01/31 15:07:30 INFO ResourceUtils: Resources for spark.executor:

21/01/31 15:07:30 INFO ResourceUtils: ==============================================================
21/01/31 15:07:30 INFO CoarseGrainedExecutorBackend: Successfully registered with driver
21/01/31 15:07:30 INFO Executor: Starting executor ID 4 on host 192.168.11.7
21/01/31 15:07:30 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 65034.
21/01/31 15:07:30 INFO NettyBlockTransferService: Server created on 192.168.11.7:65034
21/01/31 15:07:30 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
21/01/31 15:07:30 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(4, 192.168.11.7, 65034, None)
21/01/31 15:07:30 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(4, 192.168.11.7, 65034, None)
21/01/31 15:07:30 INFO BlockManager: Initialized BlockManager: BlockManagerId(4, 192.168.11.7, 65034, None)
21/01/31 15:07:34 INFO CoarseGrainedExecutorBackend: Got assigned task 10
21/01/31 15:07:34 INFO CoarseGrainedExecutorBackend: Got assigned task 20
21/01/31 15:07:34 INFO Executor: Running task 9.0 in stage 1.0 (TID 10)
21/01/31 15:07:34 INFO Executor: Running task 19.0 in stage 1.0 (TID 20)
21/01/31 15:07:34 INFO Executor: Fetching spark://192.168.11.7:64981/jars/simple-project_2.12-1.0.jar with timestamp 1612073245272
21/01/31 15:07:34 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 6 ms (0 ms spent in bootstraps)
21/01/31 15:07:34 INFO Utils: Fetching spark://192.168.11.7:64981/jars/simple-project_2.12-1.0.jar to /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-fb50bbc1-385d-42b4-ab16-c5d025f6423b/executor-7267174c-0d59-4d62-8ba2-58f503363917/spark-f5fcc465-403c-48ad-9138-a7568bf511b6/fetchFileTemp8736005709492326766.tmp
21/01/31 15:07:34 INFO Utils: Copying /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-fb50bbc1-385d-42b4-ab16-c5d025f6423b/executor-7267174c-0d59-4d62-8ba2-58f503363917/spark-f5fcc465-403c-48ad-9138-a7568bf511b6/14468519141612073245272_cache to /Users/kinsho/workspace/spark-3.0.1/work/app-20210131150725-0034/4/./simple-project_2.12-1.0.jar
21/01/31 15:07:35 INFO Executor: Adding file:/Users/kinsho/workspace/spark-3.0.1/work/app-20210131150725-0034/4/./simple-project_2.12-1.0.jar to class loader
21/01/31 15:07:35 INFO TorrentBroadcast: Started reading broadcast variable 4 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:07:35 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:65035 after 6 ms (0 ms spent in bootstraps)
21/01/31 15:07:35 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 14.0 KiB, free 366.3 MiB)
21/01/31 15:07:35 INFO TorrentBroadcast: Reading broadcast variable 4 took 445 ms
21/01/31 15:07:36 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 39.7 KiB, free 366.2 MiB)
21/01/31 15:07:39 INFO CodeGenerator: Code generated in 1224.7183 ms
21/01/31 15:07:39 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 2550136832-2684354560, partition values: [empty row]
21/01/31 15:07:39 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 1207959552-1342177280, partition values: [empty row]
21/01/31 15:07:40 INFO CodeGenerator: Code generated in 142.361504 ms
21/01/31 15:07:40 INFO TorrentBroadcast: Started reading broadcast variable 3 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:07:40 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:65044 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:07:40 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 24.0 KiB, free 366.2 MiB)
21/01/31 15:07:40 INFO TorrentBroadcast: Reading broadcast variable 3 took 142 ms
21/01/31 15:07:40 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 336.8 KiB, free 365.9 MiB)
21/01/31 15:08:04 INFO Executor: Finished task 9.0 in stage 1.0 (TID 10). 2022 bytes result sent to driver
21/01/31 15:08:04 INFO CoarseGrainedExecutorBackend: Got assigned task 36
21/01/31 15:08:04 INFO Executor: Running task 35.0 in stage 1.0 (TID 36)
21/01/31 15:08:04 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 4697620480-4831838208, partition values: [empty row]
21/01/31 15:08:06 INFO Executor: Finished task 19.0 in stage 1.0 (TID 20). 2022 bytes result sent to driver
21/01/31 15:08:06 INFO CoarseGrainedExecutorBackend: Got assigned task 39
21/01/31 15:08:06 INFO Executor: Running task 38.0 in stage 1.0 (TID 39)
21/01/31 15:08:06 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 5100273664-5234491392, partition values: [empty row]
21/01/31 15:08:24 INFO Executor: Finished task 35.0 in stage 1.0 (TID 36). 2022 bytes result sent to driver
21/01/31 15:08:24 INFO CoarseGrainedExecutorBackend: Got assigned task 55
21/01/31 15:08:24 INFO Executor: Running task 54.0 in stage 1.0 (TID 55)
21/01/31 15:08:24 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 7247757312-7381975040, partition values: [empty row]
21/01/31 15:08:25 INFO Executor: Finished task 38.0 in stage 1.0 (TID 39). 2022 bytes result sent to driver
21/01/31 15:08:25 INFO CoarseGrainedExecutorBackend: Got assigned task 59
21/01/31 15:08:25 INFO Executor: Running task 58.0 in stage 1.0 (TID 59)
21/01/31 15:08:25 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 7784628224-7918845952, partition values: [empty row]
21/01/31 15:08:44 INFO Executor: Finished task 54.0 in stage 1.0 (TID 55). 2022 bytes result sent to driver
21/01/31 15:08:44 INFO CoarseGrainedExecutorBackend: Got assigned task 74
21/01/31 15:08:44 INFO Executor: Running task 73.0 in stage 1.0 (TID 74)
21/01/31 15:08:44 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 9797894144-9932111872, partition values: [empty row]
21/01/31 15:08:45 INFO Executor: Finished task 58.0 in stage 1.0 (TID 59). 2022 bytes result sent to driver
21/01/31 15:08:45 INFO CoarseGrainedExecutorBackend: Got assigned task 78
21/01/31 15:08:45 INFO Executor: Running task 77.0 in stage 1.0 (TID 78)
21/01/31 15:08:45 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 10334765056-10468982784, partition values: [empty row]
21/01/31 15:09:02 INFO Executor: Finished task 73.0 in stage 1.0 (TID 74). 2022 bytes result sent to driver
21/01/31 15:09:02 INFO CoarseGrainedExecutorBackend: Got assigned task 96
21/01/31 15:09:02 INFO Executor: Running task 95.0 in stage 1.0 (TID 96)
21/01/31 15:09:02 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 12750684160-12884901888, partition values: [empty row]
21/01/31 15:09:02 INFO Executor: Finished task 77.0 in stage 1.0 (TID 78). 2022 bytes result sent to driver
21/01/31 15:09:02 INFO CoarseGrainedExecutorBackend: Got assigned task 98
21/01/31 15:09:02 INFO Executor: Running task 97.0 in stage 1.0 (TID 98)
21/01/31 15:09:02 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 13019119616-13153337344, partition values: [empty row]
21/01/31 15:09:20 INFO Executor: Finished task 97.0 in stage 1.0 (TID 98). 2022 bytes result sent to driver
21/01/31 15:09:20 INFO CoarseGrainedExecutorBackend: Got assigned task 115
21/01/31 15:09:20 INFO Executor: Running task 114.0 in stage 1.0 (TID 115)
21/01/31 15:09:20 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 15300820992-15435038720, partition values: [empty row]
21/01/31 15:09:20 INFO Executor: Finished task 95.0 in stage 1.0 (TID 96). 2022 bytes result sent to driver
21/01/31 15:09:20 INFO CoarseGrainedExecutorBackend: Got assigned task 116
21/01/31 15:09:20 INFO Executor: Running task 115.0 in stage 1.0 (TID 116)
21/01/31 15:09:20 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 15435038720-15569256448, partition values: [empty row]
21/01/31 15:09:37 INFO Executor: Finished task 115.0 in stage 1.0 (TID 116). 2022 bytes result sent to driver
21/01/31 15:09:37 INFO CoarseGrainedExecutorBackend: Got assigned task 134
21/01/31 15:09:37 INFO Executor: Running task 133.0 in stage 1.0 (TID 134)
21/01/31 15:09:37 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 17850957824-17985175552, partition values: [empty row]
21/01/31 15:09:37 INFO Executor: Finished task 114.0 in stage 1.0 (TID 115). 2022 bytes result sent to driver
21/01/31 15:09:37 INFO CoarseGrainedExecutorBackend: Got assigned task 136
21/01/31 15:09:37 INFO Executor: Running task 135.0 in stage 1.0 (TID 136)
21/01/31 15:09:37 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 18119393280-18253611008, partition values: [empty row]
21/01/31 15:09:53 INFO Executor: Finished task 135.0 in stage 1.0 (TID 136). 2022 bytes result sent to driver
21/01/31 15:09:53 INFO CoarseGrainedExecutorBackend: Got assigned task 154
21/01/31 15:09:53 INFO Executor: Running task 153.0 in stage 1.0 (TID 154)
21/01/31 15:09:53 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 20535312384-20669530112, partition values: [empty row]
21/01/31 15:09:53 INFO Executor: Finished task 133.0 in stage 1.0 (TID 134). 2022 bytes result sent to driver
21/01/31 15:09:53 INFO CoarseGrainedExecutorBackend: Got assigned task 155
21/01/31 15:09:53 INFO Executor: Running task 154.0 in stage 1.0 (TID 155)
21/01/31 15:09:53 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 20669530112-20803747840, partition values: [empty row]
21/01/31 15:10:09 INFO Executor: Finished task 154.0 in stage 1.0 (TID 155). 2022 bytes result sent to driver
21/01/31 15:10:09 INFO CoarseGrainedExecutorBackend: Got assigned task 172
21/01/31 15:10:09 INFO Executor: Running task 171.0 in stage 1.0 (TID 172)
21/01/31 15:10:09 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 22951231488-23085449216, partition values: [empty row]
21/01/31 15:10:09 INFO Executor: Finished task 153.0 in stage 1.0 (TID 154). 2022 bytes result sent to driver
21/01/31 15:10:09 INFO CoarseGrainedExecutorBackend: Got assigned task 174
21/01/31 15:10:09 INFO Executor: Running task 173.0 in stage 1.0 (TID 174)
21/01/31 15:10:09 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 23219666944-23353884672, partition values: [empty row]
21/01/31 15:10:20 INFO Executor: Finished task 171.0 in stage 1.0 (TID 172). 2022 bytes result sent to driver
21/01/31 15:10:20 INFO Executor: Finished task 173.0 in stage 1.0 (TID 174). 2022 bytes result sent to driver
21/01/31 15:10:21 INFO CoarseGrainedExecutorBackend: Got assigned task 184
21/01/31 15:10:21 INFO CoarseGrainedExecutorBackend: Got assigned task 194
21/01/31 15:10:21 INFO Executor: Running task 16.0 in stage 3.0 (TID 194)
21/01/31 15:10:21 INFO Executor: Running task 6.0 in stage 3.0 (TID 184)
21/01/31 15:10:21 INFO MapOutputTrackerWorker: Updating epoch to 1 and clearing cache
21/01/31 15:10:21 INFO TorrentBroadcast: Started reading broadcast variable 7 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:10:21 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64987 after 3 ms (0 ms spent in bootstraps)
21/01/31 15:10:21 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 59.3 KiB, free 365.9 MiB)
21/01/31 15:10:21 INFO TorrentBroadcast: Reading broadcast variable 7 took 340 ms
21/01/31 15:10:21 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 169.2 KiB, free 365.7 MiB)
21/01/31 15:10:22 INFO CodeGenerator: Code generated in 88.927828 ms
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 805306368-939524096, partition values: [empty row]
21/01/31 15:10:22 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 2147483648-2281701376, partition values: [empty row]
21/01/31 15:10:22 INFO CodeGenerator: Code generated in 28.788005 ms
21/01/31 15:10:22 INFO TorrentBroadcast: Started reading broadcast variable 6 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:10:22 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:65043 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:10:22 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 24.0 KiB, free 366.1 MiB)
21/01/31 15:10:22 INFO TorrentBroadcast: Reading broadcast variable 6 took 120 ms
21/01/31 15:10:22 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 336.8 KiB, free 365.7 MiB)
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:22 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:22 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:22 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 15:10:22 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 15:10:38 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 38170915
21/01/31 15:10:39 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000006_184' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000006
21/01/31 15:10:39 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000006_184: Committed
21/01/31 15:10:39 INFO Executor: Finished task 6.0 in stage 3.0 (TID 184). 2356 bytes result sent to driver
21/01/31 15:10:39 INFO CoarseGrainedExecutorBackend: Got assigned task 205
21/01/31 15:10:39 INFO Executor: Running task 27.0 in stage 3.0 (TID 205)
21/01/31 15:10:39 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:39 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:39 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:39 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:39 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 3623878656-3758096384, partition values: [empty row]
21/01/31 15:10:39 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:39 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:39 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:39 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:39 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:39 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:39 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:39 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:39 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:39 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:39 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:39 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:39 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:41 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 42854867
21/01/31 15:10:41 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000016_194' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000016
21/01/31 15:10:41 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000016_194: Committed
21/01/31 15:10:41 INFO Executor: Finished task 16.0 in stage 3.0 (TID 194). 2313 bytes result sent to driver
21/01/31 15:10:41 INFO CoarseGrainedExecutorBackend: Got assigned task 216
21/01/31 15:10:41 INFO Executor: Running task 38.0 in stage 3.0 (TID 216)
21/01/31 15:10:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:41 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:41 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:41 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 5100273664-5234491392, partition values: [empty row]
21/01/31 15:10:41 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:41 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:41 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:41 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:41 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:41 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:41 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:41 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:41 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:41 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:41 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:41 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:41 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:54 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 40920172
21/01/31 15:10:54 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000027_205' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000027
21/01/31 15:10:54 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000027_205: Committed
21/01/31 15:10:54 INFO Executor: Finished task 27.0 in stage 3.0 (TID 205). 2313 bytes result sent to driver
21/01/31 15:10:55 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 38621455
21/01/31 15:10:55 INFO CoarseGrainedExecutorBackend: Got assigned task 229
21/01/31 15:10:55 INFO Executor: Running task 51.0 in stage 3.0 (TID 229)
21/01/31 15:10:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:55 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:55 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:55 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 6845104128-6979321856, partition values: [empty row]
21/01/31 15:10:55 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:55 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:55 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:55 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:55 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:55 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:55 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:55 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:55 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:55 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:55 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:55 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:55 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:55 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000038_216' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000038
21/01/31 15:10:55 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000038_216: Committed
21/01/31 15:10:55 INFO Executor: Finished task 38.0 in stage 3.0 (TID 216). 2313 bytes result sent to driver
21/01/31 15:10:56 INFO CoarseGrainedExecutorBackend: Got assigned task 237
21/01/31 15:10:56 INFO Executor: Running task 59.0 in stage 3.0 (TID 237)
21/01/31 15:10:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:56 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:56 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:56 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 7918845952-8053063680, partition values: [empty row]
21/01/31 15:10:56 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:56 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:56 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:56 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:56 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:56 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:56 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:56 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:56 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:56 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:56 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:56 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:56 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:13 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37629367
21/01/31 15:11:13 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000051_229' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000051
21/01/31 15:11:13 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000051_229: Committed
21/01/31 15:11:13 INFO Executor: Finished task 51.0 in stage 3.0 (TID 229). 2313 bytes result sent to driver
21/01/31 15:11:13 INFO CoarseGrainedExecutorBackend: Got assigned task 247
21/01/31 15:11:13 INFO Executor: Running task 69.0 in stage 3.0 (TID 247)
21/01/31 15:11:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:13 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:13 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:13 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 9261023232-9395240960, partition values: [empty row]
21/01/31 15:11:13 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:13 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:13 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:13 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:13 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:13 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:13 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:13 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:13 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:13 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:13 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:13 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:13 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:14 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37515918
21/01/31 15:11:15 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000059_237' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000059
21/01/31 15:11:15 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000059_237: Committed
21/01/31 15:11:15 INFO Executor: Finished task 59.0 in stage 3.0 (TID 237). 2313 bytes result sent to driver
21/01/31 15:11:15 INFO CoarseGrainedExecutorBackend: Got assigned task 257
21/01/31 15:11:15 INFO Executor: Running task 79.0 in stage 3.0 (TID 257)
21/01/31 15:11:15 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:15 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:15 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:15 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:15 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 10603200512-10737418240, partition values: [empty row]
21/01/31 15:11:15 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:15 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:15 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:15 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:15 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:15 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:15 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:15 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:15 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:15 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:15 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:15 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:15 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:29 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37090210
21/01/31 15:11:29 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000069_247' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000069
21/01/31 15:11:29 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000069_247: Committed
21/01/31 15:11:29 INFO Executor: Finished task 69.0 in stage 3.0 (TID 247). 2313 bytes result sent to driver
21/01/31 15:11:29 INFO CoarseGrainedExecutorBackend: Got assigned task 268
21/01/31 15:11:29 INFO Executor: Running task 90.0 in stage 3.0 (TID 268)
21/01/31 15:11:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:29 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:29 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:29 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:29 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 12079595520-12213813248, partition values: [empty row]
21/01/31 15:11:29 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:29 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:29 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:29 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:29 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:29 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:29 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:29 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:29 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:29 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:29 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:29 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:29 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:30 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35950552
21/01/31 15:11:31 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000079_257' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000079
21/01/31 15:11:31 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000079_257: Committed
21/01/31 15:11:31 INFO Executor: Finished task 79.0 in stage 3.0 (TID 257). 2313 bytes result sent to driver
21/01/31 15:11:31 INFO CoarseGrainedExecutorBackend: Got assigned task 276
21/01/31 15:11:31 INFO Executor: Running task 98.0 in stage 3.0 (TID 276)
21/01/31 15:11:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:31 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:31 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:31 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 13153337344-13287555072, partition values: [empty row]
21/01/31 15:11:31 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:31 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:31 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:31 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:31 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:31 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:31 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:31 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:31 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:31 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:31 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:31 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:31 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:45 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35275761
21/01/31 15:11:45 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000090_268' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000090
21/01/31 15:11:45 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000090_268: Committed
21/01/31 15:11:45 INFO Executor: Finished task 90.0 in stage 3.0 (TID 268). 2313 bytes result sent to driver
21/01/31 15:11:45 INFO CoarseGrainedExecutorBackend: Got assigned task 290
21/01/31 15:11:45 INFO Executor: Running task 112.0 in stage 3.0 (TID 290)
21/01/31 15:11:45 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:45 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:45 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:45 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:45 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 15032385536-15166603264, partition values: [empty row]
21/01/31 15:11:45 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:45 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:45 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:45 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:45 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:45 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:45 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:45 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:45 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:45 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:45 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:45 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:45 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:47 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35385960
21/01/31 15:11:47 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000098_276' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000098
21/01/31 15:11:47 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000098_276: Committed
21/01/31 15:11:47 INFO Executor: Finished task 98.0 in stage 3.0 (TID 276). 2313 bytes result sent to driver
21/01/31 15:11:47 INFO CoarseGrainedExecutorBackend: Got assigned task 297
21/01/31 15:11:47 INFO Executor: Running task 119.0 in stage 3.0 (TID 297)
21/01/31 15:11:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:47 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 15971909632-16106127360, partition values: [empty row]
21/01/31 15:11:47 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:47 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:47 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:47 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:47 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:47 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:47 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:47 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:47 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:47 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:47 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:47 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:47 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:59 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35204974
21/01/31 15:11:59 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000112_290' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000112
21/01/31 15:11:59 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000112_290: Committed
21/01/31 15:11:59 INFO Executor: Finished task 112.0 in stage 3.0 (TID 290). 2313 bytes result sent to driver
21/01/31 15:11:59 INFO CoarseGrainedExecutorBackend: Got assigned task 311
21/01/31 15:11:59 INFO Executor: Running task 133.0 in stage 3.0 (TID 311)
21/01/31 15:11:59 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:59 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:59 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:59 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:59 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 17850957824-17985175552, partition values: [empty row]
21/01/31 15:11:59 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:59 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:59 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:59 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:59 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:59 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:59 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:59 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:59 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:59 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:59 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:59 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:59 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:00 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35227785
21/01/31 15:12:01 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000119_297' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000119
21/01/31 15:12:01 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000119_297: Committed
21/01/31 15:12:01 INFO Executor: Finished task 119.0 in stage 3.0 (TID 297). 2313 bytes result sent to driver
21/01/31 15:12:01 INFO CoarseGrainedExecutorBackend: Got assigned task 317
21/01/31 15:12:01 INFO Executor: Running task 139.0 in stage 3.0 (TID 317)
21/01/31 15:12:01 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:01 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:01 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:01 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:01 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 18656264192-18790481920, partition values: [empty row]
21/01/31 15:12:01 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:01 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:01 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:01 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:01 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:01 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:01 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:01 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:01 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:01 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:01 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:01 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:01 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:12 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35097443
21/01/31 15:12:12 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000133_311' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000133
21/01/31 15:12:12 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000133_311: Committed
21/01/31 15:12:12 INFO Executor: Finished task 133.0 in stage 3.0 (TID 311). 2313 bytes result sent to driver
21/01/31 15:12:12 INFO CoarseGrainedExecutorBackend: Got assigned task 331
21/01/31 15:12:12 INFO Executor: Running task 153.0 in stage 3.0 (TID 331)
21/01/31 15:12:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:12 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:12 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:12 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 20535312384-20669530112, partition values: [empty row]
21/01/31 15:12:12 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:12 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:12 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:12 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:12 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:12 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:12 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:12 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:12 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:12 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:12 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:12 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:12 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:13 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35134266
21/01/31 15:12:13 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000139_317' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000139
21/01/31 15:12:13 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000139_317: Committed
21/01/31 15:12:13 INFO Executor: Finished task 139.0 in stage 3.0 (TID 317). 2313 bytes result sent to driver
21/01/31 15:12:13 INFO CoarseGrainedExecutorBackend: Got assigned task 337
21/01/31 15:12:13 INFO Executor: Running task 159.0 in stage 3.0 (TID 337)
21/01/31 15:12:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:13 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:13 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:13 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 21340618752-21474836480, partition values: [empty row]
21/01/31 15:12:14 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:14 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:14 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:14 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:14 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:14 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:14 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:14 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:14 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:14 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:14 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:14 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:14 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:24 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36257615
21/01/31 15:12:24 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000153_331' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000153
21/01/31 15:12:24 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000153_331: Committed
21/01/31 15:12:24 INFO Executor: Finished task 153.0 in stage 3.0 (TID 331). 2313 bytes result sent to driver
21/01/31 15:12:24 INFO CoarseGrainedExecutorBackend: Got assigned task 352
21/01/31 15:12:24 INFO Executor: Running task 174.0 in stage 3.0 (TID 352)
21/01/31 15:12:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:24 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:24 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:24 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:24 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 23353884672-23488102400, partition values: [empty row]
21/01/31 15:12:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:24 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:24 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:24 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:24 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:24 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:24 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:24 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:24 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:24 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:24 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:24 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:24 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:25 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35872292
21/01/31 15:12:25 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000159_337' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000159
21/01/31 15:12:25 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000159_337: Committed
21/01/31 15:12:25 INFO Executor: Finished task 159.0 in stage 3.0 (TID 337). 2313 bytes result sent to driver
21/01/31 15:12:32 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 34656505
21/01/31 15:12:33 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000174_352' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000174
21/01/31 15:12:33 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000174_352: Committed
21/01/31 15:12:33 INFO Executor: Finished task 174.0 in stage 3.0 (TID 352). 2313 bytes result sent to driver
21/01/31 15:12:33 INFO CoarseGrainedExecutorBackend: Driver commanded a shutdown
