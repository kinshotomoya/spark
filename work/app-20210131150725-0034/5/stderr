Spark Executor Command: "/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/bin/java" "-cp" "/Users/kinsho/workspace/spark-3.0.1/conf/:/Users/kinsho/workspace/spark-3.0.1/assembly/target/scala-2.12/jars/*" "-Xmx1024M" "-Dspark.driver.port=64981" "org.apache.spark.executor.CoarseGrainedExecutorBackend" "--driver-url" "spark://CoarseGrainedScheduler@192.168.11.7:64981" "--executor-id" "5" "--hostname" "192.168.11.7" "--cores" "2" "--app-id" "app-20210131150725-0034" "--worker-url" "spark://Worker@192.168.11.7:63901"
========================================

Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
21/01/31 15:07:27 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 30073@ST000000035
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for TERM
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for HUP
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for INT
21/01/31 15:07:28 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
21/01/31 15:07:28 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 15:07:28 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 15:07:28 INFO SecurityManager: Changing view acls groups to: 
21/01/31 15:07:28 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 15:07:28 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 15:07:29 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 166 ms (0 ms spent in bootstraps)
21/01/31 15:07:29 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 15:07:29 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 15:07:29 INFO SecurityManager: Changing view acls groups to: 
21/01/31 15:07:29 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 15:07:29 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 15:07:29 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 7 ms (0 ms spent in bootstraps)
21/01/31 15:07:29 INFO DiskBlockManager: Created local directory at /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-102929ca-e5d8-4f9d-8f5f-261f7d02820c/executor-932405b4-c110-4485-b6eb-6c353380d82d/blockmgr-69632c4d-ac03-4a5f-9116-633c38f7bf92
21/01/31 15:07:30 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
21/01/31 15:07:30 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@192.168.11.7:64981
21/01/31 15:07:30 INFO WorkerWatcher: Connecting to worker spark://Worker@192.168.11.7:63901
21/01/31 15:07:30 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:63901 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:07:30 INFO ResourceUtils: ==============================================================
21/01/31 15:07:30 INFO ResourceUtils: Resources for spark.executor:

21/01/31 15:07:30 INFO ResourceUtils: ==============================================================
21/01/31 15:07:30 INFO CoarseGrainedExecutorBackend: Successfully registered with driver
21/01/31 15:07:30 INFO Executor: Starting executor ID 5 on host 192.168.11.7
21/01/31 15:07:30 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 65037.
21/01/31 15:07:30 INFO NettyBlockTransferService: Server created on 192.168.11.7:65037
21/01/31 15:07:30 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
21/01/31 15:07:30 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(5, 192.168.11.7, 65037, None)
21/01/31 15:07:30 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(5, 192.168.11.7, 65037, None)
21/01/31 15:07:30 INFO BlockManager: Initialized BlockManager: BlockManagerId(5, 192.168.11.7, 65037, None)
21/01/31 15:07:34 INFO CoarseGrainedExecutorBackend: Got assigned task 8
21/01/31 15:07:34 INFO CoarseGrainedExecutorBackend: Got assigned task 18
21/01/31 15:07:34 INFO Executor: Running task 17.0 in stage 1.0 (TID 18)
21/01/31 15:07:34 INFO Executor: Running task 7.0 in stage 1.0 (TID 8)
21/01/31 15:07:34 INFO Executor: Fetching spark://192.168.11.7:64981/jars/simple-project_2.12-1.0.jar with timestamp 1612073245272
21/01/31 15:07:34 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 9 ms (0 ms spent in bootstraps)
21/01/31 15:07:34 INFO Utils: Fetching spark://192.168.11.7:64981/jars/simple-project_2.12-1.0.jar to /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-102929ca-e5d8-4f9d-8f5f-261f7d02820c/executor-932405b4-c110-4485-b6eb-6c353380d82d/spark-4ef7250a-3f05-4099-9de5-937564ba4f9d/fetchFileTemp6966527293926387390.tmp
21/01/31 15:07:34 INFO Utils: Copying /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-102929ca-e5d8-4f9d-8f5f-261f7d02820c/executor-932405b4-c110-4485-b6eb-6c353380d82d/spark-4ef7250a-3f05-4099-9de5-937564ba4f9d/14468519141612073245272_cache to /Users/kinsho/workspace/spark-3.0.1/work/app-20210131150725-0034/5/./simple-project_2.12-1.0.jar
21/01/31 15:07:34 INFO Executor: Adding file:/Users/kinsho/workspace/spark-3.0.1/work/app-20210131150725-0034/5/./simple-project_2.12-1.0.jar to class loader
21/01/31 15:07:35 INFO TorrentBroadcast: Started reading broadcast variable 4 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:07:35 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64987 after 13 ms (0 ms spent in bootstraps)
21/01/31 15:07:35 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 14.0 KiB, free 366.3 MiB)
21/01/31 15:07:35 INFO TorrentBroadcast: Reading broadcast variable 4 took 442 ms
21/01/31 15:07:36 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 39.7 KiB, free 366.2 MiB)
21/01/31 15:07:39 INFO CodeGenerator: Code generated in 1320.134147 ms
21/01/31 15:07:39 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 939524096-1073741824, partition values: [empty row]
21/01/31 15:07:39 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 2281701376-2415919104, partition values: [empty row]
21/01/31 15:07:40 INFO CodeGenerator: Code generated in 152.870803 ms
21/01/31 15:07:40 INFO TorrentBroadcast: Started reading broadcast variable 3 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:07:40 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:65035 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:07:40 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 24.0 KiB, free 366.2 MiB)
21/01/31 15:07:40 INFO TorrentBroadcast: Reading broadcast variable 3 took 208 ms
21/01/31 15:07:40 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 336.8 KiB, free 365.9 MiB)
21/01/31 15:08:02 INFO Executor: Finished task 7.0 in stage 1.0 (TID 8). 2022 bytes result sent to driver
21/01/31 15:08:02 INFO CoarseGrainedExecutorBackend: Got assigned task 28
21/01/31 15:08:02 INFO Executor: Running task 27.0 in stage 1.0 (TID 28)
21/01/31 15:08:02 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 3623878656-3758096384, partition values: [empty row]
21/01/31 15:08:04 INFO Executor: Finished task 17.0 in stage 1.0 (TID 18). 2022 bytes result sent to driver
21/01/31 15:08:04 INFO CoarseGrainedExecutorBackend: Got assigned task 35
21/01/31 15:08:04 INFO Executor: Running task 34.0 in stage 1.0 (TID 35)
21/01/31 15:08:04 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 4563402752-4697620480, partition values: [empty row]
21/01/31 15:08:23 INFO Executor: Finished task 27.0 in stage 1.0 (TID 28). 2022 bytes result sent to driver
21/01/31 15:08:23 INFO CoarseGrainedExecutorBackend: Got assigned task 45
21/01/31 15:08:23 INFO Executor: Running task 44.0 in stage 1.0 (TID 45)
21/01/31 15:08:23 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 5905580032-6039797760, partition values: [empty row]
21/01/31 15:08:24 INFO Executor: Finished task 34.0 in stage 1.0 (TID 35). 2022 bytes result sent to driver
21/01/31 15:08:24 INFO CoarseGrainedExecutorBackend: Got assigned task 52
21/01/31 15:08:24 INFO Executor: Running task 51.0 in stage 1.0 (TID 52)
21/01/31 15:08:24 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 6845104128-6979321856, partition values: [empty row]
21/01/31 15:08:43 INFO Executor: Finished task 44.0 in stage 1.0 (TID 45). 2022 bytes result sent to driver
21/01/31 15:08:43 INFO CoarseGrainedExecutorBackend: Got assigned task 68
21/01/31 15:08:43 INFO Executor: Running task 67.0 in stage 1.0 (TID 68)
21/01/31 15:08:43 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 8992587776-9126805504, partition values: [empty row]
21/01/31 15:08:44 INFO Executor: Finished task 51.0 in stage 1.0 (TID 52). 2022 bytes result sent to driver
21/01/31 15:08:44 INFO CoarseGrainedExecutorBackend: Got assigned task 75
21/01/31 15:08:44 INFO Executor: Running task 74.0 in stage 1.0 (TID 75)
21/01/31 15:08:44 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 9932111872-10066329600, partition values: [empty row]
21/01/31 15:09:01 INFO Executor: Finished task 67.0 in stage 1.0 (TID 68). 2022 bytes result sent to driver
21/01/31 15:09:01 INFO CoarseGrainedExecutorBackend: Got assigned task 90
21/01/31 15:09:01 INFO Executor: Running task 89.0 in stage 1.0 (TID 90)
21/01/31 15:09:01 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 11945377792-12079595520, partition values: [empty row]
21/01/31 15:09:02 INFO Executor: Finished task 74.0 in stage 1.0 (TID 75). 2022 bytes result sent to driver
21/01/31 15:09:02 INFO CoarseGrainedExecutorBackend: Got assigned task 95
21/01/31 15:09:02 INFO Executor: Running task 94.0 in stage 1.0 (TID 95)
21/01/31 15:09:02 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 12616466432-12750684160, partition values: [empty row]
21/01/31 15:09:19 INFO Executor: Finished task 89.0 in stage 1.0 (TID 90). 2022 bytes result sent to driver
21/01/31 15:09:19 INFO CoarseGrainedExecutorBackend: Got assigned task 111
21/01/31 15:09:19 INFO Executor: Running task 110.0 in stage 1.0 (TID 111)
21/01/31 15:09:19 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 14763950080-14898167808, partition values: [empty row]
21/01/31 15:09:19 INFO Executor: Finished task 94.0 in stage 1.0 (TID 95). 2022 bytes result sent to driver
21/01/31 15:09:19 INFO CoarseGrainedExecutorBackend: Got assigned task 112
21/01/31 15:09:19 INFO Executor: Running task 111.0 in stage 1.0 (TID 112)
21/01/31 15:09:19 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 14898167808-15032385536, partition values: [empty row]
21/01/31 15:09:36 INFO Executor: Finished task 110.0 in stage 1.0 (TID 111). 2022 bytes result sent to driver
21/01/31 15:09:36 INFO CoarseGrainedExecutorBackend: Got assigned task 130
21/01/31 15:09:36 INFO Executor: Running task 129.0 in stage 1.0 (TID 130)
21/01/31 15:09:36 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 17314086912-17448304640, partition values: [empty row]
21/01/31 15:09:36 INFO Executor: Finished task 111.0 in stage 1.0 (TID 112). 2022 bytes result sent to driver
21/01/31 15:09:36 INFO CoarseGrainedExecutorBackend: Got assigned task 133
21/01/31 15:09:36 INFO Executor: Running task 132.0 in stage 1.0 (TID 133)
21/01/31 15:09:36 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 17716740096-17850957824, partition values: [empty row]
21/01/31 15:09:53 INFO Executor: Finished task 132.0 in stage 1.0 (TID 133). 2022 bytes result sent to driver
21/01/31 15:09:53 INFO CoarseGrainedExecutorBackend: Got assigned task 151
21/01/31 15:09:53 INFO Executor: Running task 150.0 in stage 1.0 (TID 151)
21/01/31 15:09:53 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 20132659200-20266876928, partition values: [empty row]
21/01/31 15:09:53 INFO Executor: Finished task 129.0 in stage 1.0 (TID 130). 2022 bytes result sent to driver
21/01/31 15:09:53 INFO CoarseGrainedExecutorBackend: Got assigned task 153
21/01/31 15:09:53 INFO Executor: Running task 152.0 in stage 1.0 (TID 153)
21/01/31 15:09:53 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 20401094656-20535312384, partition values: [empty row]
21/01/31 15:10:09 INFO Executor: Finished task 150.0 in stage 1.0 (TID 151). 2022 bytes result sent to driver
21/01/31 15:10:09 INFO CoarseGrainedExecutorBackend: Got assigned task 171
21/01/31 15:10:09 INFO Executor: Running task 170.0 in stage 1.0 (TID 171)
21/01/31 15:10:09 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 22817013760-22951231488, partition values: [empty row]
21/01/31 15:10:09 INFO Executor: Finished task 152.0 in stage 1.0 (TID 153). 2022 bytes result sent to driver
21/01/31 15:10:09 INFO CoarseGrainedExecutorBackend: Got assigned task 173
21/01/31 15:10:09 INFO Executor: Running task 172.0 in stage 1.0 (TID 173)
21/01/31 15:10:09 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 23085449216-23219666944, partition values: [empty row]
21/01/31 15:10:20 INFO Executor: Finished task 172.0 in stage 1.0 (TID 173). 2022 bytes result sent to driver
21/01/31 15:10:20 INFO Executor: Finished task 170.0 in stage 1.0 (TID 171). 2022 bytes result sent to driver
21/01/31 15:10:21 INFO CoarseGrainedExecutorBackend: Got assigned task 181
21/01/31 15:10:21 INFO Executor: Running task 3.0 in stage 3.0 (TID 181)
21/01/31 15:10:21 INFO CoarseGrainedExecutorBackend: Got assigned task 191
21/01/31 15:10:21 INFO Executor: Running task 13.0 in stage 3.0 (TID 191)
21/01/31 15:10:21 INFO MapOutputTrackerWorker: Updating epoch to 1 and clearing cache
21/01/31 15:10:21 INFO TorrentBroadcast: Started reading broadcast variable 7 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:10:21 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 59.3 KiB, free 365.8 MiB)
21/01/31 15:10:21 INFO TorrentBroadcast: Reading broadcast variable 7 took 20 ms
21/01/31 15:10:21 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 169.2 KiB, free 365.7 MiB)
21/01/31 15:10:21 INFO CodeGenerator: Code generated in 74.180145 ms
21/01/31 15:10:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:21 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:21 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:21 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:21 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 1744830464-1879048192, partition values: [empty row]
21/01/31 15:10:21 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 402653184-536870912, partition values: [empty row]
21/01/31 15:10:21 INFO CodeGenerator: Code generated in 24.754883 ms
21/01/31 15:10:21 INFO TorrentBroadcast: Started reading broadcast variable 6 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:10:21 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 24.0 KiB, free 365.7 MiB)
21/01/31 15:10:22 INFO TorrentBroadcast: Reading broadcast variable 6 took 281 ms
21/01/31 15:10:22 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 336.8 KiB, free 365.7 MiB)
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:22 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:22 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:22 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 15:10:22 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 15:10:38 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37800370
21/01/31 15:10:38 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000003_181' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000003
21/01/31 15:10:38 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000003_181: Committed
21/01/31 15:10:38 INFO Executor: Finished task 3.0 in stage 3.0 (TID 181). 2356 bytes result sent to driver
21/01/31 15:10:38 INFO CoarseGrainedExecutorBackend: Got assigned task 198
21/01/31 15:10:38 INFO Executor: Running task 20.0 in stage 3.0 (TID 198)
21/01/31 15:10:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:38 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:38 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:38 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:38 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 2684354560-2818572288, partition values: [empty row]
21/01/31 15:10:38 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:38 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:38 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:38 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:38 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:38 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:38 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:38 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:38 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:38 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:38 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:38 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:38 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:39 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 41412370
21/01/31 15:10:40 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000013_191' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000013
21/01/31 15:10:40 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000013_191: Committed
21/01/31 15:10:40 INFO Executor: Finished task 13.0 in stage 3.0 (TID 191). 2313 bytes result sent to driver
21/01/31 15:10:40 INFO CoarseGrainedExecutorBackend: Got assigned task 206
21/01/31 15:10:40 INFO Executor: Running task 28.0 in stage 3.0 (TID 206)
21/01/31 15:10:40 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:40 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:40 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:40 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:40 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 3758096384-3892314112, partition values: [empty row]
21/01/31 15:10:40 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:40 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:40 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:40 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:40 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:40 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:40 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:40 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:40 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:40 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:40 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:40 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:40 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:53 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 42615494
21/01/31 15:10:53 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 40462610
21/01/31 15:10:53 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000020_198' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000020
21/01/31 15:10:53 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000020_198: Committed
21/01/31 15:10:53 INFO Executor: Finished task 20.0 in stage 3.0 (TID 198). 2313 bytes result sent to driver
21/01/31 15:10:53 INFO CoarseGrainedExecutorBackend: Got assigned task 219
21/01/31 15:10:53 INFO Executor: Running task 41.0 in stage 3.0 (TID 219)
21/01/31 15:10:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:53 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:53 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:53 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 5502926848-5637144576, partition values: [empty row]
21/01/31 15:10:53 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:53 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:53 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:53 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:53 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:53 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:53 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:53 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:53 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:53 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:53 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:53 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:53 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:53 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000028_206' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000028
21/01/31 15:10:53 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000028_206: Committed
21/01/31 15:10:53 INFO Executor: Finished task 28.0 in stage 3.0 (TID 206). 2313 bytes result sent to driver
21/01/31 15:10:53 INFO CoarseGrainedExecutorBackend: Got assigned task 220
21/01/31 15:10:53 INFO Executor: Running task 42.0 in stage 3.0 (TID 220)
21/01/31 15:10:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:53 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:53 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:53 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:53 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 5637144576-5771362304, partition values: [empty row]
21/01/31 15:10:53 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:53 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:53 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:53 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:53 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:53 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:53 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:53 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:53 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:53 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:53 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:53 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:53 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:11 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 38551941
21/01/31 15:11:11 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 38127032
21/01/31 15:11:11 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000041_219' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000041
21/01/31 15:11:11 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000041_219: Committed
21/01/31 15:11:11 INFO Executor: Finished task 41.0 in stage 3.0 (TID 219). 2313 bytes result sent to driver
21/01/31 15:11:11 INFO CoarseGrainedExecutorBackend: Got assigned task 240
21/01/31 15:11:11 INFO Executor: Running task 62.0 in stage 3.0 (TID 240)
21/01/31 15:11:11 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:11 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:11 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:11 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:11 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 8321499136-8455716864, partition values: [empty row]
21/01/31 15:11:11 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:11 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:11 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:11 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:11 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:11 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:11 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:11 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:11 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:11 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:11 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:11 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:11 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:12 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000042_220' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000042
21/01/31 15:11:12 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000042_220: Committed
21/01/31 15:11:12 INFO Executor: Finished task 42.0 in stage 3.0 (TID 220). 2313 bytes result sent to driver
21/01/31 15:11:12 INFO CoarseGrainedExecutorBackend: Got assigned task 241
21/01/31 15:11:12 INFO Executor: Running task 63.0 in stage 3.0 (TID 241)
21/01/31 15:11:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:12 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:12 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:12 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 8455716864-8589934592, partition values: [empty row]
21/01/31 15:11:12 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:12 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:12 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:12 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:12 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:12 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:12 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:12 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:12 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:12 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:12 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:12 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:12 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:26 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37284984
21/01/31 15:11:26 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36805555
21/01/31 15:11:26 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000062_240' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000062
21/01/31 15:11:26 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000062_240: Committed
21/01/31 15:11:26 INFO Executor: Finished task 62.0 in stage 3.0 (TID 240). 2313 bytes result sent to driver
21/01/31 15:11:26 INFO CoarseGrainedExecutorBackend: Got assigned task 260
21/01/31 15:11:26 INFO Executor: Running task 82.0 in stage 3.0 (TID 260)
21/01/31 15:11:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:26 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:26 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:26 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 11005853696-11140071424, partition values: [empty row]
21/01/31 15:11:26 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:26 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:26 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:26 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:26 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:26 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:26 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:26 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:26 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:26 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:26 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:26 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:26 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:26 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000063_241' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000063
21/01/31 15:11:26 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000063_241: Committed
21/01/31 15:11:26 INFO Executor: Finished task 63.0 in stage 3.0 (TID 241). 2313 bytes result sent to driver
21/01/31 15:11:26 INFO CoarseGrainedExecutorBackend: Got assigned task 261
21/01/31 15:11:26 INFO Executor: Running task 83.0 in stage 3.0 (TID 261)
21/01/31 15:11:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:26 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:26 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:26 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:26 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 11140071424-11274289152, partition values: [empty row]
21/01/31 15:11:26 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:26 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:26 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:26 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:26 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:26 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:26 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:26 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:26 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:26 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:26 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:26 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:27 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:41 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35918317
21/01/31 15:11:41 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36115141
21/01/31 15:11:42 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000082_260' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000082
21/01/31 15:11:42 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000082_260: Committed
21/01/31 15:11:42 INFO Executor: Finished task 82.0 in stage 3.0 (TID 260). 2313 bytes result sent to driver
21/01/31 15:11:42 INFO CoarseGrainedExecutorBackend: Got assigned task 280
21/01/31 15:11:42 INFO Executor: Running task 102.0 in stage 3.0 (TID 280)
21/01/31 15:11:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:42 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:42 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:42 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 13690208256-13824425984, partition values: [empty row]
21/01/31 15:11:42 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:42 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:42 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:42 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:42 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:42 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:42 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:42 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:42 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:42 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:42 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:42 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:42 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:42 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000083_261' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000083
21/01/31 15:11:42 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000083_261: Committed
21/01/31 15:11:42 INFO Executor: Finished task 83.0 in stage 3.0 (TID 261). 2313 bytes result sent to driver
21/01/31 15:11:42 INFO CoarseGrainedExecutorBackend: Got assigned task 281
21/01/31 15:11:42 INFO Executor: Running task 103.0 in stage 3.0 (TID 281)
21/01/31 15:11:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:42 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:42 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:42 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:42 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 13824425984-13958643712, partition values: [empty row]
21/01/31 15:11:42 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:42 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:42 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:42 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:42 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:42 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:42 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:42 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:42 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:42 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:42 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:42 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:42 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:55 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35684300
21/01/31 15:11:55 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000102_280' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000102
21/01/31 15:11:55 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000102_280: Committed
21/01/31 15:11:55 INFO Executor: Finished task 102.0 in stage 3.0 (TID 280). 2313 bytes result sent to driver
21/01/31 15:11:55 INFO CoarseGrainedExecutorBackend: Got assigned task 300
21/01/31 15:11:55 INFO Executor: Running task 122.0 in stage 3.0 (TID 300)
21/01/31 15:11:55 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 34746767
21/01/31 15:11:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:55 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:55 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:55 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 16374562816-16508780544, partition values: [empty row]
21/01/31 15:11:55 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:56 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:56 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:56 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:56 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:56 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:56 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:56 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:56 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:56 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:56 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:56 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:56 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:56 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000103_281' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000103
21/01/31 15:11:56 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000103_281: Committed
21/01/31 15:11:56 INFO Executor: Finished task 103.0 in stage 3.0 (TID 281). 2313 bytes result sent to driver
21/01/31 15:11:56 INFO CoarseGrainedExecutorBackend: Got assigned task 301
21/01/31 15:11:56 INFO Executor: Running task 123.0 in stage 3.0 (TID 301)
21/01/31 15:11:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:56 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:56 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:56 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 16508780544-16642998272, partition values: [empty row]
21/01/31 15:11:56 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:56 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:56 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:56 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:56 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:56 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:56 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:56 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:56 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:56 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:56 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:56 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:56 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:07 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35219002
21/01/31 15:12:08 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35342618
21/01/31 15:12:08 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000122_300' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000122
21/01/31 15:12:08 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000122_300: Committed
21/01/31 15:12:08 INFO Executor: Finished task 122.0 in stage 3.0 (TID 300). 2313 bytes result sent to driver
21/01/31 15:12:08 INFO CoarseGrainedExecutorBackend: Got assigned task 320
21/01/31 15:12:08 INFO Executor: Running task 142.0 in stage 3.0 (TID 320)
21/01/31 15:12:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:08 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:08 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:08 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 19058917376-19193135104, partition values: [empty row]
21/01/31 15:12:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:08 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:08 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:08 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:08 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:08 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:08 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:08 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:08 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:08 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:08 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:08 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:08 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000123_301' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000123
21/01/31 15:12:08 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000123_301: Committed
21/01/31 15:12:08 INFO Executor: Finished task 123.0 in stage 3.0 (TID 301). 2313 bytes result sent to driver
21/01/31 15:12:08 INFO CoarseGrainedExecutorBackend: Got assigned task 321
21/01/31 15:12:08 INFO Executor: Running task 143.0 in stage 3.0 (TID 321)
21/01/31 15:12:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:08 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:08 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:08 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:08 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 19193135104-19327352832, partition values: [empty row]
21/01/31 15:12:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:08 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:08 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:08 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:08 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:08 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:08 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:08 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:08 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:08 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:08 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:08 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:08 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:19 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35610283
21/01/31 15:12:19 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35515705
21/01/31 15:12:19 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000143_321' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000143
21/01/31 15:12:19 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000143_321: Committed
21/01/31 15:12:19 INFO Executor: Finished task 143.0 in stage 3.0 (TID 321). 2313 bytes result sent to driver
21/01/31 15:12:19 INFO CoarseGrainedExecutorBackend: Got assigned task 340
21/01/31 15:12:19 INFO Executor: Running task 162.0 in stage 3.0 (TID 340)
21/01/31 15:12:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:19 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:19 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:19 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 21743271936-21877489664, partition values: [empty row]
21/01/31 15:12:19 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:19 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:19 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:19 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:19 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:19 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:19 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:19 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:19 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:19 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:19 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:19 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:19 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:19 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000142_320' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000142
21/01/31 15:12:19 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000142_320: Committed
21/01/31 15:12:19 INFO Executor: Finished task 142.0 in stage 3.0 (TID 320). 2313 bytes result sent to driver
21/01/31 15:12:19 INFO CoarseGrainedExecutorBackend: Got assigned task 341
21/01/31 15:12:19 INFO Executor: Running task 163.0 in stage 3.0 (TID 341)
21/01/31 15:12:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:19 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:19 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:19 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:19 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 21877489664-22011707392, partition values: [empty row]
21/01/31 15:12:19 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:19 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:19 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:19 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:19 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:19 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:19 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:19 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:19 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:19 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:19 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:19 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:19 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:29 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35772534
21/01/31 15:12:29 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35627654
21/01/31 15:12:29 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000163_341' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000163
21/01/31 15:12:29 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000163_341: Committed
21/01/31 15:12:29 INFO Executor: Finished task 163.0 in stage 3.0 (TID 341). 2313 bytes result sent to driver
21/01/31 15:12:29 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000162_340' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000162
21/01/31 15:12:29 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000162_340: Committed
21/01/31 15:12:29 INFO Executor: Finished task 162.0 in stage 3.0 (TID 340). 2313 bytes result sent to driver
21/01/31 15:12:33 INFO CoarseGrainedExecutorBackend: Driver commanded a shutdown
