Spark Executor Command: "/Library/Java/JavaVirtualMachines/adoptopenjdk-8.jdk/Contents/Home/jre/bin/java" "-cp" "/Users/kinsho/workspace/spark-3.0.1/conf/:/Users/kinsho/workspace/spark-3.0.1/assembly/target/scala-2.12/jars/*" "-Xmx1024M" "-Dspark.driver.port=64981" "org.apache.spark.executor.CoarseGrainedExecutorBackend" "--driver-url" "spark://CoarseGrainedScheduler@192.168.11.7:64981" "--executor-id" "3" "--hostname" "192.168.11.7" "--cores" "2" "--app-id" "app-20210131150725-0034" "--worker-url" "spark://Worker@192.168.11.7:63954"
========================================

Using Spark's default log4j profile: org/apache/spark/log4j-defaults.properties
21/01/31 15:07:27 INFO CoarseGrainedExecutorBackend: Started daemon with process name: 30072@ST000000035
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for TERM
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for HUP
21/01/31 15:07:27 INFO SignalUtils: Registered signal handler for INT
21/01/31 15:07:28 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
21/01/31 15:07:28 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 15:07:28 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 15:07:28 INFO SecurityManager: Changing view acls groups to: 
21/01/31 15:07:28 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 15:07:28 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 15:07:29 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 176 ms (0 ms spent in bootstraps)
21/01/31 15:07:29 INFO SecurityManager: Changing view acls to: kinsho
21/01/31 15:07:29 INFO SecurityManager: Changing modify acls to: kinsho
21/01/31 15:07:29 INFO SecurityManager: Changing view acls groups to: 
21/01/31 15:07:29 INFO SecurityManager: Changing modify acls groups to: 
21/01/31 15:07:29 INFO SecurityManager: SecurityManager: authentication disabled; ui acls disabled; users  with view permissions: Set(kinsho); groups with view permissions: Set(); users  with modify permissions: Set(kinsho); groups with modify permissions: Set()
21/01/31 15:07:29 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:07:29 INFO DiskBlockManager: Created local directory at /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-3ab0568a-ea0f-4ede-9044-9b9b119a7a74/executor-5203f701-d1f7-4554-a890-0b6550d03999/blockmgr-2b37e845-eb9a-4098-a40f-ed5257a96bc2
21/01/31 15:07:30 INFO MemoryStore: MemoryStore started with capacity 366.3 MiB
21/01/31 15:07:30 INFO CoarseGrainedExecutorBackend: Connecting to driver: spark://CoarseGrainedScheduler@192.168.11.7:64981
21/01/31 15:07:30 INFO WorkerWatcher: Connecting to worker spark://Worker@192.168.11.7:63954
21/01/31 15:07:30 INFO ResourceUtils: ==============================================================
21/01/31 15:07:30 INFO ResourceUtils: Resources for spark.executor:

21/01/31 15:07:30 INFO ResourceUtils: ==============================================================
21/01/31 15:07:30 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:63954 after 3 ms (0 ms spent in bootstraps)
21/01/31 15:07:30 INFO CoarseGrainedExecutorBackend: Successfully registered with driver
21/01/31 15:07:30 INFO Executor: Starting executor ID 3 on host 192.168.11.7
21/01/31 15:07:30 INFO Utils: Successfully started service 'org.apache.spark.network.netty.NettyBlockTransferService' on port 65040.
21/01/31 15:07:30 INFO NettyBlockTransferService: Server created on 192.168.11.7:65040
21/01/31 15:07:30 INFO BlockManager: Using org.apache.spark.storage.RandomBlockReplicationPolicy for block replication policy
21/01/31 15:07:30 INFO BlockManagerMaster: Registering BlockManager BlockManagerId(3, 192.168.11.7, 65040, None)
21/01/31 15:07:30 INFO BlockManagerMaster: Registered BlockManager BlockManagerId(3, 192.168.11.7, 65040, None)
21/01/31 15:07:30 INFO BlockManager: Initialized BlockManager: BlockManagerId(3, 192.168.11.7, 65040, None)
21/01/31 15:07:34 INFO CoarseGrainedExecutorBackend: Got assigned task 2
21/01/31 15:07:34 INFO CoarseGrainedExecutorBackend: Got assigned task 12
21/01/31 15:07:34 INFO Executor: Running task 1.0 in stage 1.0 (TID 2)
21/01/31 15:07:34 INFO Executor: Running task 11.0 in stage 1.0 (TID 12)
21/01/31 15:07:34 INFO Executor: Fetching spark://192.168.11.7:64981/jars/simple-project_2.12-1.0.jar with timestamp 1612073245272
21/01/31 15:07:34 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64981 after 11 ms (0 ms spent in bootstraps)
21/01/31 15:07:34 INFO Utils: Fetching spark://192.168.11.7:64981/jars/simple-project_2.12-1.0.jar to /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-3ab0568a-ea0f-4ede-9044-9b9b119a7a74/executor-5203f701-d1f7-4554-a890-0b6550d03999/spark-b4967487-cc6a-4a4b-8ae0-938f495b2b7c/fetchFileTemp1014199238829723597.tmp
21/01/31 15:07:34 INFO Utils: Copying /private/var/folders/tm/7v5m6cg144g467bsj7zgsxgc0000gn/T/spark-3ab0568a-ea0f-4ede-9044-9b9b119a7a74/executor-5203f701-d1f7-4554-a890-0b6550d03999/spark-b4967487-cc6a-4a4b-8ae0-938f495b2b7c/14468519141612073245272_cache to /Users/kinsho/workspace/spark-3.0.1/work/app-20210131150725-0034/3/./simple-project_2.12-1.0.jar
21/01/31 15:07:35 INFO Executor: Adding file:/Users/kinsho/workspace/spark-3.0.1/work/app-20210131150725-0034/3/./simple-project_2.12-1.0.jar to class loader
21/01/31 15:07:35 INFO TorrentBroadcast: Started reading broadcast variable 4 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:07:35 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:65035 after 11 ms (0 ms spent in bootstraps)
21/01/31 15:07:35 INFO MemoryStore: Block broadcast_4_piece0 stored as bytes in memory (estimated size 14.0 KiB, free 366.3 MiB)
21/01/31 15:07:35 INFO TorrentBroadcast: Reading broadcast variable 4 took 436 ms
21/01/31 15:07:36 INFO MemoryStore: Block broadcast_4 stored as values in memory (estimated size 39.7 KiB, free 366.2 MiB)
21/01/31 15:07:40 INFO CodeGenerator: Code generated in 1461.719953 ms
21/01/31 15:07:40 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 134217728-268435456, partition values: [empty row]
21/01/31 15:07:40 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 1476395008-1610612736, partition values: [empty row]
21/01/31 15:07:40 INFO CodeGenerator: Code generated in 205.738303 ms
21/01/31 15:07:40 INFO TorrentBroadcast: Started reading broadcast variable 3 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:07:40 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:65044 after 2 ms (0 ms spent in bootstraps)
21/01/31 15:07:40 INFO MemoryStore: Block broadcast_3_piece0 stored as bytes in memory (estimated size 24.0 KiB, free 366.2 MiB)
21/01/31 15:07:40 INFO TorrentBroadcast: Reading broadcast variable 3 took 33 ms
21/01/31 15:07:40 INFO MemoryStore: Block broadcast_3 stored as values in memory (estimated size 336.8 KiB, free 365.9 MiB)
21/01/31 15:08:02 INFO Executor: Finished task 1.0 in stage 1.0 (TID 2). 2022 bytes result sent to driver
21/01/31 15:08:02 INFO CoarseGrainedExecutorBackend: Got assigned task 25
21/01/31 15:08:02 INFO Executor: Running task 24.0 in stage 1.0 (TID 25)
21/01/31 15:08:02 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 3221225472-3355443200, partition values: [empty row]
21/01/31 15:08:03 INFO Executor: Finished task 11.0 in stage 1.0 (TID 12). 2022 bytes result sent to driver
21/01/31 15:08:03 INFO CoarseGrainedExecutorBackend: Got assigned task 32
21/01/31 15:08:04 INFO Executor: Running task 31.0 in stage 1.0 (TID 32)
21/01/31 15:08:04 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 4160749568-4294967296, partition values: [empty row]
21/01/31 15:08:23 INFO Executor: Finished task 24.0 in stage 1.0 (TID 25). 2022 bytes result sent to driver
21/01/31 15:08:23 INFO CoarseGrainedExecutorBackend: Got assigned task 44
21/01/31 15:08:23 INFO Executor: Running task 43.0 in stage 1.0 (TID 44)
21/01/31 15:08:23 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 5771362304-5905580032, partition values: [empty row]
21/01/31 15:08:24 INFO Executor: Finished task 31.0 in stage 1.0 (TID 32). 2022 bytes result sent to driver
21/01/31 15:08:24 INFO CoarseGrainedExecutorBackend: Got assigned task 50
21/01/31 15:08:24 INFO Executor: Running task 49.0 in stage 1.0 (TID 50)
21/01/31 15:08:24 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 6576668672-6710886400, partition values: [empty row]
21/01/31 15:08:42 INFO Executor: Finished task 43.0 in stage 1.0 (TID 44). 2022 bytes result sent to driver
21/01/31 15:08:42 INFO CoarseGrainedExecutorBackend: Got assigned task 66
21/01/31 15:08:42 INFO Executor: Running task 65.0 in stage 1.0 (TID 66)
21/01/31 15:08:42 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 8724152320-8858370048, partition values: [empty row]
21/01/31 15:08:43 INFO Executor: Finished task 49.0 in stage 1.0 (TID 50). 2022 bytes result sent to driver
21/01/31 15:08:43 INFO CoarseGrainedExecutorBackend: Got assigned task 70
21/01/31 15:08:43 INFO Executor: Running task 69.0 in stage 1.0 (TID 70)
21/01/31 15:08:43 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 9261023232-9395240960, partition values: [empty row]
21/01/31 15:09:01 INFO Executor: Finished task 65.0 in stage 1.0 (TID 66). 2022 bytes result sent to driver
21/01/31 15:09:01 INFO CoarseGrainedExecutorBackend: Got assigned task 87
21/01/31 15:09:01 INFO Executor: Running task 86.0 in stage 1.0 (TID 87)
21/01/31 15:09:01 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 11542724608-11676942336, partition values: [empty row]
21/01/31 15:09:01 INFO Executor: Finished task 69.0 in stage 1.0 (TID 70). 2022 bytes result sent to driver
21/01/31 15:09:01 INFO CoarseGrainedExecutorBackend: Got assigned task 89
21/01/31 15:09:01 INFO Executor: Running task 88.0 in stage 1.0 (TID 89)
21/01/31 15:09:01 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 11811160064-11945377792, partition values: [empty row]
21/01/31 15:09:18 INFO Executor: Finished task 86.0 in stage 1.0 (TID 87). 2022 bytes result sent to driver
21/01/31 15:09:18 INFO CoarseGrainedExecutorBackend: Got assigned task 106
21/01/31 15:09:18 INFO Executor: Running task 105.0 in stage 1.0 (TID 106)
21/01/31 15:09:18 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 14092861440-14227079168, partition values: [empty row]
21/01/31 15:09:19 INFO Executor: Finished task 88.0 in stage 1.0 (TID 89). 2022 bytes result sent to driver
21/01/31 15:09:19 INFO CoarseGrainedExecutorBackend: Got assigned task 110
21/01/31 15:09:19 INFO Executor: Running task 109.0 in stage 1.0 (TID 110)
21/01/31 15:09:19 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 14629732352-14763950080, partition values: [empty row]
21/01/31 15:09:35 INFO Executor: Finished task 105.0 in stage 1.0 (TID 106). 2022 bytes result sent to driver
21/01/31 15:09:35 INFO CoarseGrainedExecutorBackend: Got assigned task 126
21/01/31 15:09:35 INFO Executor: Running task 125.0 in stage 1.0 (TID 126)
21/01/31 15:09:35 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 16777216000-16911433728, partition values: [empty row]
21/01/31 15:09:36 INFO Executor: Finished task 109.0 in stage 1.0 (TID 110). 2022 bytes result sent to driver
21/01/31 15:09:36 INFO CoarseGrainedExecutorBackend: Got assigned task 132
21/01/31 15:09:36 INFO Executor: Running task 131.0 in stage 1.0 (TID 132)
21/01/31 15:09:36 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 17582522368-17716740096, partition values: [empty row]
21/01/31 15:09:52 INFO Executor: Finished task 125.0 in stage 1.0 (TID 126). 2022 bytes result sent to driver
21/01/31 15:09:52 INFO CoarseGrainedExecutorBackend: Got assigned task 146
21/01/31 15:09:52 INFO Executor: Running task 145.0 in stage 1.0 (TID 146)
21/01/31 15:09:52 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 19461570560-19595788288, partition values: [empty row]
21/01/31 15:09:53 INFO Executor: Finished task 131.0 in stage 1.0 (TID 132). 2022 bytes result sent to driver
21/01/31 15:09:53 INFO CoarseGrainedExecutorBackend: Got assigned task 150
21/01/31 15:09:53 INFO Executor: Running task 149.0 in stage 1.0 (TID 150)
21/01/31 15:09:53 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 19998441472-20132659200, partition values: [empty row]
21/01/31 15:10:09 INFO Executor: Finished task 145.0 in stage 1.0 (TID 146). 2022 bytes result sent to driver
21/01/31 15:10:09 INFO CoarseGrainedExecutorBackend: Got assigned task 166
21/01/31 15:10:09 INFO Executor: Running task 165.0 in stage 1.0 (TID 166)
21/01/31 15:10:09 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 22145925120-22280142848, partition values: [empty row]
21/01/31 15:10:09 INFO Executor: Finished task 149.0 in stage 1.0 (TID 150). 2022 bytes result sent to driver
21/01/31 15:10:09 INFO CoarseGrainedExecutorBackend: Got assigned task 170
21/01/31 15:10:09 INFO Executor: Running task 169.0 in stage 1.0 (TID 170)
21/01/31 15:10:09 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 22682796032-22817013760, partition values: [empty row]
21/01/31 15:10:20 INFO Executor: Finished task 165.0 in stage 1.0 (TID 166). 2022 bytes result sent to driver
21/01/31 15:10:20 INFO Executor: Finished task 169.0 in stage 1.0 (TID 170). 2022 bytes result sent to driver
21/01/31 15:10:21 INFO CoarseGrainedExecutorBackend: Got assigned task 187
21/01/31 15:10:21 INFO CoarseGrainedExecutorBackend: Got assigned task 197
21/01/31 15:10:21 INFO Executor: Running task 19.0 in stage 3.0 (TID 197)
21/01/31 15:10:21 INFO Executor: Running task 9.0 in stage 3.0 (TID 187)
21/01/31 15:10:21 INFO MapOutputTrackerWorker: Updating epoch to 1 and clearing cache
21/01/31 15:10:21 INFO TorrentBroadcast: Started reading broadcast variable 7 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:10:21 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:64987 after 6 ms (0 ms spent in bootstraps)
21/01/31 15:10:21 INFO MemoryStore: Block broadcast_7_piece0 stored as bytes in memory (estimated size 59.3 KiB, free 365.9 MiB)
21/01/31 15:10:21 INFO TorrentBroadcast: Reading broadcast variable 7 took 336 ms
21/01/31 15:10:21 INFO MemoryStore: Block broadcast_7 stored as values in memory (estimated size 169.2 KiB, free 365.7 MiB)
21/01/31 15:10:22 INFO CodeGenerator: Code generated in 58.285796 ms
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 1207959552-1342177280, partition values: [empty row]
21/01/31 15:10:22 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:22 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 2550136832-2684354560, partition values: [empty row]
21/01/31 15:10:22 INFO CodeGenerator: Code generated in 25.259292 ms
21/01/31 15:10:22 INFO TorrentBroadcast: Started reading broadcast variable 6 with 1 pieces (estimated total size 4.0 MiB)
21/01/31 15:10:22 INFO TransportClientFactory: Successfully created connection to /192.168.11.7:65043 after 1 ms (0 ms spent in bootstraps)
21/01/31 15:10:22 INFO MemoryStore: Block broadcast_6_piece0 stored as bytes in memory (estimated size 24.0 KiB, free 366.1 MiB)
21/01/31 15:10:22 INFO TorrentBroadcast: Reading broadcast variable 6 took 127 ms
21/01/31 15:10:22 INFO MemoryStore: Block broadcast_6 stored as values in memory (estimated size 336.8 KiB, free 365.7 MiB)
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:22 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:22 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:22 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:22 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:22 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:22 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:22 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:22 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:22 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:22 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 15:10:22 INFO CodecPool: Got brand-new compressor [.snappy]
21/01/31 15:10:39 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 40331031
21/01/31 15:10:40 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000009_187' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000009
21/01/31 15:10:40 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000009_187: Committed
21/01/31 15:10:40 INFO Executor: Finished task 9.0 in stage 3.0 (TID 187). 2356 bytes result sent to driver
21/01/31 15:10:40 INFO CoarseGrainedExecutorBackend: Got assigned task 209
21/01/31 15:10:40 INFO Executor: Running task 31.0 in stage 3.0 (TID 209)
21/01/31 15:10:40 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:40 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:40 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:40 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:40 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 4160749568-4294967296, partition values: [empty row]
21/01/31 15:10:40 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:40 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:40 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:40 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:40 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:40 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:40 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:40 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:40 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:40 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:40 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:40 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:40 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:41 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 43089558
21/01/31 15:10:41 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000019_197' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000019
21/01/31 15:10:41 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000019_197: Committed
21/01/31 15:10:41 INFO Executor: Finished task 19.0 in stage 3.0 (TID 197). 2313 bytes result sent to driver
21/01/31 15:10:41 INFO CoarseGrainedExecutorBackend: Got assigned task 215
21/01/31 15:10:41 INFO Executor: Running task 37.0 in stage 3.0 (TID 215)
21/01/31 15:10:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:41 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:41 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:41 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:41 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 4966055936-5100273664, partition values: [empty row]
21/01/31 15:10:41 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:41 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:41 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:41 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:41 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:41 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:41 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:41 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:41 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:41 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:41 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:41 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:41 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:54 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 40215384
21/01/31 15:10:55 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000031_209' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000031
21/01/31 15:10:55 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000031_209: Committed
21/01/31 15:10:55 INFO Executor: Finished task 31.0 in stage 3.0 (TID 209). 2313 bytes result sent to driver
21/01/31 15:10:55 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 38899243
21/01/31 15:10:55 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000037_215' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000037
21/01/31 15:10:55 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000037_215: Committed
21/01/31 15:10:55 INFO Executor: Finished task 37.0 in stage 3.0 (TID 215). 2313 bytes result sent to driver
21/01/31 15:10:55 INFO CoarseGrainedExecutorBackend: Got assigned task 233
21/01/31 15:10:55 INFO Executor: Running task 55.0 in stage 3.0 (TID 233)
21/01/31 15:10:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:55 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:55 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:55 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:55 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 7381975040-7516192768, partition values: [empty row]
21/01/31 15:10:55 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:55 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:55 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:55 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:55 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:55 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:55 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:55 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:55 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:55 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:55 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:55 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:55 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:10:56 INFO CoarseGrainedExecutorBackend: Got assigned task 234
21/01/31 15:10:56 INFO Executor: Running task 56.0 in stage 3.0 (TID 234)
21/01/31 15:10:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:56 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:56 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:10:56 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:10:56 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 7516192768-7650410496, partition values: [empty row]
21/01/31 15:10:56 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:56 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:10:56 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:10:56 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:10:56 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:10:56 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:10:56 INFO ParquetOutputFormat: Validation is off
21/01/31 15:10:56 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:10:56 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:10:56 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:10:56 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:10:56 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:10:56 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:14 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37692854
21/01/31 15:11:14 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000055_233' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000055
21/01/31 15:11:14 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000055_233: Committed
21/01/31 15:11:14 INFO Executor: Finished task 55.0 in stage 3.0 (TID 233). 2313 bytes result sent to driver
21/01/31 15:11:14 INFO CoarseGrainedExecutorBackend: Got assigned task 253
21/01/31 15:11:14 INFO Executor: Running task 75.0 in stage 3.0 (TID 253)
21/01/31 15:11:14 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:14 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:14 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:14 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:14 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 10066329600-10200547328, partition values: [empty row]
21/01/31 15:11:14 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:14 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:14 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:14 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:14 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:14 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:14 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:14 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:14 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:14 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:14 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:14 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:14 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:15 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 37840119
21/01/31 15:11:15 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000056_234' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000056
21/01/31 15:11:15 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000056_234: Committed
21/01/31 15:11:15 INFO Executor: Finished task 56.0 in stage 3.0 (TID 234). 2313 bytes result sent to driver
21/01/31 15:11:15 INFO CoarseGrainedExecutorBackend: Got assigned task 256
21/01/31 15:11:15 INFO Executor: Running task 78.0 in stage 3.0 (TID 256)
21/01/31 15:11:15 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:15 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:15 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:15 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:15 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 10468982784-10603200512, partition values: [empty row]
21/01/31 15:11:15 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:15 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:15 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:15 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:15 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:15 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:15 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:15 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:15 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:15 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:15 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:15 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:15 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:30 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36503079
21/01/31 15:11:30 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000075_253' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000075
21/01/31 15:11:30 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000075_253: Committed
21/01/31 15:11:30 INFO Executor: Finished task 75.0 in stage 3.0 (TID 253). 2313 bytes result sent to driver
21/01/31 15:11:30 INFO CoarseGrainedExecutorBackend: Got assigned task 275
21/01/31 15:11:30 INFO Executor: Running task 97.0 in stage 3.0 (TID 275)
21/01/31 15:11:30 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:30 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:30 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:30 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:30 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 13019119616-13153337344, partition values: [empty row]
21/01/31 15:11:30 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:30 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:30 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:30 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:30 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:30 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:30 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:30 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:30 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:30 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:30 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:30 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:30 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:30 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36291589
21/01/31 15:11:31 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000078_256' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000078
21/01/31 15:11:31 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000078_256: Committed
21/01/31 15:11:31 INFO Executor: Finished task 78.0 in stage 3.0 (TID 256). 2313 bytes result sent to driver
21/01/31 15:11:31 INFO CoarseGrainedExecutorBackend: Got assigned task 277
21/01/31 15:11:31 INFO Executor: Running task 99.0 in stage 3.0 (TID 277)
21/01/31 15:11:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:31 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:31 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:31 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:31 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 13287555072-13421772800, partition values: [empty row]
21/01/31 15:11:31 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:31 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:31 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:31 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:31 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:31 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:31 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:31 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:31 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:31 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:31 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:31 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:31 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:46 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35608570
21/01/31 15:11:46 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000097_275' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000097
21/01/31 15:11:46 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000097_275: Committed
21/01/31 15:11:46 INFO Executor: Finished task 97.0 in stage 3.0 (TID 275). 2313 bytes result sent to driver
21/01/31 15:11:46 INFO CoarseGrainedExecutorBackend: Got assigned task 293
21/01/31 15:11:46 INFO Executor: Running task 115.0 in stage 3.0 (TID 293)
21/01/31 15:11:46 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:46 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:46 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:46 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:46 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 15435038720-15569256448, partition values: [empty row]
21/01/31 15:11:46 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:46 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:46 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:46 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:46 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:46 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:46 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:46 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:46 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:46 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:46 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:46 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:46 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:47 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35930678
21/01/31 15:11:47 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000099_277' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000099
21/01/31 15:11:47 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000099_277: Committed
21/01/31 15:11:47 INFO Executor: Finished task 99.0 in stage 3.0 (TID 277). 2313 bytes result sent to driver
21/01/31 15:11:47 INFO CoarseGrainedExecutorBackend: Got assigned task 296
21/01/31 15:11:47 INFO Executor: Running task 118.0 in stage 3.0 (TID 296)
21/01/31 15:11:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:47 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:47 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:47 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:47 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 15837691904-15971909632, partition values: [empty row]
21/01/31 15:11:47 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:47 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:47 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:47 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:47 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:47 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:47 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:47 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:47 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:47 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:47 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:47 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:47 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:11:59 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35184900
21/01/31 15:11:59 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000115_293' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000115
21/01/31 15:11:59 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000115_293: Committed
21/01/31 15:11:59 INFO Executor: Finished task 115.0 in stage 3.0 (TID 293). 2313 bytes result sent to driver
21/01/31 15:11:59 INFO CoarseGrainedExecutorBackend: Got assigned task 312
21/01/31 15:11:59 INFO Executor: Running task 134.0 in stage 3.0 (TID 312)
21/01/31 15:11:59 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:59 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:59 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:11:59 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:11:59 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 17985175552-18119393280, partition values: [empty row]
21/01/31 15:11:59 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:59 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:11:59 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:11:59 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:11:59 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:11:59 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:11:59 INFO ParquetOutputFormat: Validation is off
21/01/31 15:11:59 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:11:59 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:11:59 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:11:59 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:11:59 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:11:59 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:00 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35910165
21/01/31 15:12:00 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000118_296' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000118
21/01/31 15:12:00 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000118_296: Committed
21/01/31 15:12:00 INFO Executor: Finished task 118.0 in stage 3.0 (TID 296). 2313 bytes result sent to driver
21/01/31 15:12:00 INFO CoarseGrainedExecutorBackend: Got assigned task 316
21/01/31 15:12:00 INFO Executor: Running task 138.0 in stage 3.0 (TID 316)
21/01/31 15:12:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:00 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:00 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:00 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:00 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 18522046464-18656264192, partition values: [empty row]
21/01/31 15:12:00 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:00 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:00 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:00 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:00 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:00 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:00 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:00 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:00 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:00 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:00 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:00 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:00 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:12 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35251259
21/01/31 15:12:12 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000134_312' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000134
21/01/31 15:12:12 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000134_312: Committed
21/01/31 15:12:12 INFO Executor: Finished task 134.0 in stage 3.0 (TID 312). 2313 bytes result sent to driver
21/01/31 15:12:12 INFO CoarseGrainedExecutorBackend: Got assigned task 333
21/01/31 15:12:12 INFO Executor: Running task 155.0 in stage 3.0 (TID 333)
21/01/31 15:12:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:12 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:12 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:12 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:12 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 20803747840-20937965568, partition values: [empty row]
21/01/31 15:12:12 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:12 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:12 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:12 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:12 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:12 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:12 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:12 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:12 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:12 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:12 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:12 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:12 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:13 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 35849841
21/01/31 15:12:13 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000138_316' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000138
21/01/31 15:12:13 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000138_316: Committed
21/01/31 15:12:13 INFO Executor: Finished task 138.0 in stage 3.0 (TID 316). 2313 bytes result sent to driver
21/01/31 15:12:13 INFO CoarseGrainedExecutorBackend: Got assigned task 335
21/01/31 15:12:13 INFO Executor: Running task 157.0 in stage 3.0 (TID 335)
21/01/31 15:12:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:13 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:13 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:13 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:13 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 21072183296-21206401024, partition values: [empty row]
21/01/31 15:12:13 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:13 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:13 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:13 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:13 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:13 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:13 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:13 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:13 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:13 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:13 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:13 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:13 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:24 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36196093
21/01/31 15:12:25 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000155_333' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000155
21/01/31 15:12:25 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000155_333: Committed
21/01/31 15:12:25 INFO Executor: Finished task 155.0 in stage 3.0 (TID 333). 2313 bytes result sent to driver
21/01/31 15:12:25 INFO CoarseGrainedExecutorBackend: Got assigned task 353
21/01/31 15:12:25 INFO Executor: Running task 175.0 in stage 3.0 (TID 353)
21/01/31 15:12:25 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:25 INFO SQLHadoopMapReduceCommitProtocol: Using user defined output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:25 INFO FileOutputCommitter: File Output Committer Algorithm version is 1
21/01/31 15:12:25 INFO SQLHadoopMapReduceCommitProtocol: Using output committer class org.apache.parquet.hadoop.ParquetOutputCommitter
21/01/31 15:12:25 INFO FileScanRDD: Reading File path: file:///Users/kinsho/Desktop/impressionLog.csv, range: 23488102400-23517392614, partition values: [empty row]
21/01/31 15:12:25 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:25 INFO CodecConfig: Compression: SNAPPY
21/01/31 15:12:25 INFO ParquetOutputFormat: Parquet block size to 134217728
21/01/31 15:12:25 INFO ParquetOutputFormat: Parquet page size to 1048576
21/01/31 15:12:25 INFO ParquetOutputFormat: Parquet dictionary page size to 1048576
21/01/31 15:12:25 INFO ParquetOutputFormat: Dictionary is on
21/01/31 15:12:25 INFO ParquetOutputFormat: Validation is off
21/01/31 15:12:25 INFO ParquetOutputFormat: Writer version is: PARQUET_1_0
21/01/31 15:12:25 INFO ParquetOutputFormat: Maximum row group padding size is 8388608 bytes
21/01/31 15:12:25 INFO ParquetOutputFormat: Page size checking is: estimated
21/01/31 15:12:25 INFO ParquetOutputFormat: Min row count for page size check is: 100
21/01/31 15:12:25 INFO ParquetOutputFormat: Max row count for page size check is: 10000
21/01/31 15:12:25 INFO ParquetWriteSupport: Initialized Parquet WriteSupport with Catalyst schema:
{
  "type" : "struct",
  "fields" : [ {
    "name" : "distributionid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "advertiserid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionhourjst",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributiondatetime",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "requestid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uavalue",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "uacategory",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documentid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenturl",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "sitecode",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "documenttitle",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaignid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "campaigntype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "publisherchannelid",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "maxcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "bidcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "contractcpc",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "finalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "originalscore",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "distributionorder",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "israndom",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "jobchanneltype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "buckettype",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "predictctr",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "dt",
    "type" : "string",
    "nullable" : true,
    "metadata" : { }
  }, {
    "name" : "isGsp",
    "type" : "boolean",
    "nullable" : false,
    "metadata" : { }
  } ]
}
and corresponding Parquet message type:
message spark_schema {
  optional binary distributionid (UTF8);
  optional binary advertiserid (UTF8);
  optional binary distributionhourjst (UTF8);
  optional binary distributiondatetime (UTF8);
  optional binary requestid (UTF8);
  optional binary uid (UTF8);
  optional binary uavalue (UTF8);
  optional binary uacategory (UTF8);
  optional binary documentid (UTF8);
  optional binary documenturl (UTF8);
  optional binary sitecode (UTF8);
  optional binary documenttitle (UTF8);
  optional binary campaignid (UTF8);
  optional binary campaigntype (UTF8);
  optional binary publisherid (UTF8);
  optional binary publisherchannelid (UTF8);
  optional binary maxcpc (UTF8);
  optional binary bidcpc (UTF8);
  optional binary contractcpc (UTF8);
  optional binary finalscore (UTF8);
  optional binary originalscore (UTF8);
  optional binary distributionorder (UTF8);
  optional binary israndom (UTF8);
  optional binary jobchanneltype (UTF8);
  optional binary buckettype (UTF8);
  optional binary predictctr (UTF8);
  optional binary dt (UTF8);
  required boolean isGsp;
}

       
21/01/31 15:12:25 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 36036371
21/01/31 15:12:25 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000157_335' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000157
21/01/31 15:12:25 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000157_335: Committed
21/01/31 15:12:25 INFO Executor: Finished task 157.0 in stage 3.0 (TID 335). 2313 bytes result sent to driver
21/01/31 15:12:27 INFO InternalParquetRecordWriter: Flushing mem columnStore to file. allocated memory: 8274951
21/01/31 15:12:27 INFO FileOutputCommitter: Saved output of task 'attempt_20210131151021_0003_m_000175_353' to file:/Users/kinsho/Desktop/log/_temporary/0/task_20210131151021_0003_m_000175
21/01/31 15:12:27 INFO SparkHadoopMapRedUtil: attempt_20210131151021_0003_m_000175_353: Committed
21/01/31 15:12:27 INFO Executor: Finished task 175.0 in stage 3.0 (TID 353). 2313 bytes result sent to driver
21/01/31 15:12:33 INFO CoarseGrainedExecutorBackend: Driver commanded a shutdown
